<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Cyrus&#39; blog</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2016-04-09T04:34:43.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Cyrus</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>iOS KVO(é”®å€¼è§‚å¯Ÿ) æ€»è§ˆ</title>
    <link href="http://yoursite.com/2016/04/07/iOS-KVO-%E9%94%AE%E5%80%BC%E8%A7%82%E5%AF%9F-%E6%80%BB%E8%A7%88/"/>
    <id>http://yoursite.com/2016/04/07/iOS-KVO-é”®å€¼è§‚å¯Ÿ-æ€»è§ˆ/</id>
    <published>2016-04-07T13:59:28.000Z</published>
    <updated>2016-04-09T04:34:43.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/heading-KVO.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦å†…å®¹æ¥è‡ªäºå¯¹å®˜æ–¹æ–‡æ¡£ &lt;a href=&quot;https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html#//apple_ref/doc/uid/10000177-BCICJDHA&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Key-Value Observing Programming Guide&lt;/a&gt; çš„ç¿»è¯‘ï¼Œä»¥åŠä¸€éƒ¨åˆ†æˆ‘è‡ªå·±çš„ç†è§£å’Œè§£é‡Šï¼Œå¦‚æœæœ‰è¯´é”™çš„åœ°æ–¹è¯·åŠæ—¶è”ç³»æˆ‘ã€‚&lt;/p&gt;
&lt;h2 id=&quot;At-a-Glance&quot;&gt;&lt;a href=&quot;#At-a-Glance&quot; class=&quot;headerlink&quot; title=&quot;At a Glance&quot;&gt;&lt;/a&gt;At a Glance&lt;/h2&gt;&lt;p&gt;KVO ä¹Ÿå°±æ˜¯ é”®å€¼è§‚å¯Ÿ ï¼Œå®ƒæä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œä½¿å¾—å½“æŸä¸ªå¯¹è±¡ç‰¹å®šçš„å±æ€§å‘ç”Ÿæ”¹å˜æ—¶èƒ½å¤Ÿé€šçŸ¥åˆ°åˆ«çš„å¯¹è±¡ã€‚è¿™ç»å¸¸ç”¨äº model å’Œ controller ä¹‹é—´çš„é€šä¿¡ã€‚KVOä¸»è¦çš„ä¼˜ç‚¹æ˜¯ä½ ä¸éœ€è¦åœ¨æ¯æ¬¡å±æ€§æ”¹å˜æ—¶æ‰‹åŠ¨å»å‘é€é€šçŸ¥ã€‚å¹¶ä¸”å®ƒæ”¯æŒä¸ºä¸€ä¸ªå±æ€§æ³¨å†Œå¤šä¸ªè§‚å¯Ÿè€…ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ³¨å†Œ-KVO&quot;&gt;&lt;a href=&quot;#æ³¨å†Œ-KVO&quot; class=&quot;headerlink&quot; title=&quot;æ³¨å†Œ KVO&quot;&gt;&lt;/a&gt;æ³¨å†Œ KVO&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¢«è§‚å¯Ÿå¯¹è±¡&lt;/strong&gt; çš„å±æ€§å¿…é¡»æ˜¯ &lt;a href=&quot;file:///Users/hcy/Library/Developer/Shared/Documentation/DocSets/com.apple.adc.documentation.iOS.docset/Contents/Resources/Documents/documentation/Cocoa/Conceptual/KeyValueObserving/Articles/KVOCompliance.html#//apple_ref/doc/uid/20002178-BAJEAIEE&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;KVO Compliant&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¿…é¡»ç”¨ &lt;strong&gt;è¢«è§‚å¯Ÿå¯¹è±¡&lt;/strong&gt; çš„ &lt;code&gt;addObserver:forKeyPath:options:context:&lt;/code&gt; æ–¹æ³•æ³¨å†Œè§‚å¯Ÿè€…&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§‚å¯Ÿè€…&lt;/strong&gt; å¿…é¡»å®ç° &lt;code&gt;observeValueForKeyPath:ofObject:change:context:&lt;/code&gt; æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;æ³¨å†Œæˆä¸ºè§‚å¯Ÿè€…&quot;&gt;&lt;a href=&quot;#æ³¨å†Œæˆä¸ºè§‚å¯Ÿè€…&quot; class=&quot;headerlink&quot; title=&quot;æ³¨å†Œæˆä¸ºè§‚å¯Ÿè€…&quot;&gt;&lt;/a&gt;æ³¨å†Œæˆä¸ºè§‚å¯Ÿè€…&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;ä¸ºäº†èƒ½å¤Ÿåœ¨å±æ€§æ”¹å˜æ—¶è¢«é€šçŸ¥åˆ°ï¼Œä¸€ä¸ª &lt;strong&gt;è§‚å¯Ÿè€…å¯¹è±¡&lt;/strong&gt; å¿…é¡»é€šè¿‡ &lt;strong&gt;è¢«è§‚å¯Ÿå¯¹è±¡&lt;/strong&gt; çš„&lt;code&gt;addObserver:forKeyPath:options:context:&lt;/code&gt; æ–¹æ³•æ³¨å†Œæˆä¸ºè§‚å¯Ÿè€…ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;observer&lt;/code&gt; å‚æ•°ä¹Ÿå°±æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;keyPath&lt;/code&gt;  è¡¨ç¤ºè¦è§‚å¯Ÿçš„å±æ€§&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;options&lt;/code&gt;  å†³å®šäº†æä¾›ç»™è§‚å¯Ÿè€…changeå­—å…¸ä¸­çš„å…·ä½“ä¿¡æ¯æœ‰å“ªäº›ã€‚ï¼ˆchangeå­—å…¸æ˜¯ä¸€ä¸ªæä¾›ç»™è§‚å¯Ÿè€…çš„å‚æ•°ï¼Œåé¢ä¼šæåˆ°ï¼‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;NSKeyValueObservingOptionOld&lt;/code&gt; è¡¨ç¤ºåœ¨changeå­—å…¸ä¸­åŒ…å«äº†æ”¹å˜å‰çš„å€¼ã€‚  &lt;/li&gt;
&lt;li&gt;&lt;code&gt;NSKeyValueObservingOptionNew&lt;/code&gt; è¡¨ç¤ºåœ¨changeå­—å…¸ä¸­åŒ…å«æ–°çš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NSKeyValueObservingOptionInitial&lt;/code&gt; åœ¨æ³¨å†Œè§‚å¯Ÿè€…çš„æ–¹æ³•returnçš„æ—¶å€™å°±ä¼šå‘å‡ºä¸€æ¬¡é€šçŸ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NSKeyValueObservingOptionPrior&lt;/code&gt; ä¼šåœ¨å€¼å‘ç”Ÿæ”¹å˜å‰å‘å‡ºä¸€æ¬¡é€šçŸ¥ï¼Œå½“ç„¶æ”¹å˜åçš„é€šçŸ¥ä¾æ—§è¿˜ä¼šå‘å‡ºï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡changeéƒ½ä¼šæœ‰ä¸¤ä¸ªé€šçŸ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;context&lt;/code&gt; è¿™ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ª CæŒ‡é’ˆï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª å¯¹è±¡å¼•ç”¨ï¼Œå®ƒå¯ä»¥ä½œä¸ºè¿™ä¸ªcontextçš„å”¯ä¸€æ ‡è¯†ï¼Œä¹Ÿå¯ä»¥æä¾›ä¸€äº›æ•°æ®ç»™è§‚å¯Ÿè€…ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼š  &lt;code&gt;addObserver:forKeyPath:options:context:&lt;/code&gt; æ–¹æ³•ä¸ä¼šæŒæœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œè¢«è§‚å¯Ÿå¯¹è±¡ï¼Œä»¥åŠcontextçš„å¼ºå¼•ç”¨ã€‚ä½ è¦ç¡®ä¿è‡ªå·±æŒæœ‰äº†ä»–ä»¬çš„å¼ºå¼•ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;å±æ€§å˜åŒ–æ—¶æ¥æ”¶é€šçŸ¥&quot;&gt;&lt;a href=&quot;#å±æ€§å˜åŒ–æ—¶æ¥æ”¶é€šçŸ¥&quot; class=&quot;headerlink&quot; title=&quot;å±æ€§å˜åŒ–æ—¶æ¥æ”¶é€šçŸ¥&quot;&gt;&lt;/a&gt;å±æ€§å˜åŒ–æ—¶æ¥æ”¶é€šçŸ¥&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;å½“ä¸€ä¸ªè¢«è§‚å¯Ÿå±æ€§çš„å€¼å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè§‚å¯Ÿè€…ä¼šæ”¶åˆ° &lt;code&gt;observeValueForKeyPath:ofObject:change:context:&lt;/code&gt; çš„æ¶ˆæ¯ã€‚æ‰€æœ‰çš„è§‚å¯Ÿè€…å¿…é¡»å®ç°è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¸­çš„å‚æ•°å’Œæ³¨å†Œè§‚å¯Ÿè€…æ–¹æ³•çš„å‚æ•°åŸºæœ¬ç›¸åŒï¼Œåªæœ‰ä¸€ä¸ª &lt;code&gt;change&lt;/code&gt; ä¸åŒã€‚ &lt;code&gt;change&lt;/code&gt; æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå®ƒé‡Œé¢åŒ…å«äº†çš„ä¿¡æ¯ç”±æ³¨å†Œæ—¶çš„ &lt;code&gt;options&lt;/code&gt; å†³å®šã€‚&lt;/p&gt;
&lt;p&gt;å®˜æ–¹æä¾›äº†è¿™äº›keyç»™æˆ‘ä»¬æ¥å–åˆ° &lt;code&gt;change&lt;/code&gt; ä¸­çš„valueï¼š &lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeKindKey&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeNewKey&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeOldKey&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeIndexesKey&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeNotificationIsPriorKey&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;NSKeyValueChangeKindKey&lt;/code&gt;&lt;/strong&gt; è¿™ä¸ªkeyåŒ…å«çš„valueæ˜¯ä¸€ä¸ª NSNumber é‡Œé¢æ˜¯ä¸€ä¸ª intï¼Œä¸ä¹‹å¯¹åº”çš„æ˜¯ &lt;code&gt;NSKeyValueChange&lt;/code&gt; çš„æšä¸¾&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;enum&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeSetting&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeInsertion&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeRemoval&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeReplacement&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;NSUInteger&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;NSKeyValueChange&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“ &lt;code&gt;change[NSKeyValueChangeKindKey]&lt;/code&gt; æ˜¯ &lt;code&gt;NSKeyValueChangeSetting&lt;/code&gt; çš„æ—¶å€™ï¼Œè¯´æ˜è¢«è§‚å¯Ÿå±æ€§çš„setteræ–¹æ³•è¢«è°ƒç”¨äº†ã€‚&lt;br&gt;è€Œä¸‹é¢ä¸‰ç§ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£çš„æ„æ€æ˜¯ï¼Œå½“è¢«è§‚å¯Ÿå±æ€§æ˜¯é›†åˆç±»å‹ï¼Œä¸”å¯¹å®ƒè¿›è¡Œäº† insertï¼Œremoveï¼Œreplace æ“ä½œçš„æ—¶å€™ä¼šè¿”å›è¿™ä¸‰ç§Keyï¼Œä½†æ˜¯æˆ‘è‡ªå·±æµ‹è¯•çš„æ—¶å€™æ²¡æœ‰æµ‹è¯•å‡ºæ¥ğŸ˜“ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘ç†è§£é”™äº†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;NSKeyValueChangeNewKey&lt;/code&gt;&lt;/strong&gt;ï¼Œ&lt;strong&gt;&lt;code&gt;NSKeyValueChangeOldKey&lt;/code&gt;&lt;/strong&gt; é¡¾åæ€ä¹‰ï¼Œå½“ä½ åœ¨æ³¨å†Œçš„æ—¶å€™ &lt;code&gt;options&lt;/code&gt; å‚æ•°ä¸­å¡«äº†å¯¹åº”çš„ &lt;code&gt;NSKeyValueObservingOptionNew&lt;/code&gt; å’Œ &lt;code&gt;NSKeyValueObservingOptionOld&lt;/code&gt; ï¼Œå¹¶ä¸” &lt;code&gt;NSKeyValueChangeKindKey&lt;/code&gt; çš„å€¼æ˜¯ &lt;code&gt;NSKeyValueChangeSetting&lt;/code&gt; ï¼Œä½ å°±å¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªkeyå–åˆ° æ—§å€¼å’Œæ–°å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;NSKeyValueChangeIndexesKey&lt;/code&gt;&lt;/strong&gt;ï¼Œ å½“ &lt;code&gt;NSKeyValueChangeKindKey&lt;/code&gt; çš„ç»“æœæ˜¯ &lt;code&gt;NSKeyValueChangeInsertion&lt;/code&gt;, &lt;code&gt;NSKeyValueChangeRemoval&lt;/code&gt; æˆ– &lt;code&gt;NSKeyValueChangeReplacement&lt;/code&gt; çš„æ—¶å€™ï¼Œè¿™ä¸ªkeyçš„valueæ˜¯ä¸€ä¸ªNSIndexSetï¼ŒåŒ…å«äº†å‘ç”Ÿinsertï¼Œremoveï¼Œreplaceçš„å¯¹è±¡çš„ç´¢å¼•é›†åˆ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;NSKeyValueChangeNotificationIsPriorKey&lt;/code&gt;&lt;/strong&gt;ï¼Œè¿™ä¸ªkeyåŒ…å«äº†ä¸€ä¸ª NSNumberï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœåœ¨æ³¨å†Œæ—¶ &lt;code&gt;options&lt;/code&gt; ä¸­æœ‰ &lt;code&gt;NSKeyValueObservingOptionPrior&lt;/code&gt;ï¼Œé‚£ä¹ˆåœ¨å‰ä¸€ä¸ªé€šçŸ¥ä¸­çš„ &lt;code&gt;change&lt;/code&gt; ä¸­å°±ä¼šæœ‰è¿™ä¸ªkeyçš„valueï¼Œ æˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯åœ¨æ”¹å˜å‰çš„é€šçŸ¥&lt;code&gt;[change[NSKeyValueChangeNotificationIsPriorKey] boolValue] == YES;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…&quot;&gt;&lt;a href=&quot;#ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…&quot; class=&quot;headerlink&quot; title=&quot;ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…&quot;&gt;&lt;/a&gt;ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;ä½ å¯ä»¥é€šè¿‡ &lt;code&gt;removeObserver:forKeyPath:&lt;/code&gt; æ–¹æ³•æ¥ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿã€‚å¦‚æœä½ çš„ &lt;code&gt;context&lt;/code&gt; æ˜¯ä¸€ä¸ª å¯¹è±¡ï¼Œä½ å¿…é¡»åœ¨ç§»é™¤è§‚å¯Ÿä¹‹å‰æŒæœ‰å®ƒçš„å¼ºå¼•ç”¨ã€‚å½“ç§»é™¤äº†è§‚å¯Ÿåï¼Œè§‚å¯Ÿè€…å¯¹è±¡å†ä¹Ÿä¸ä¼šå—åˆ°è¿™ä¸ª keyPath çš„é€šçŸ¥ã€‚&lt;/p&gt;
&lt;h2 id=&quot;KVO-Compliance&quot;&gt;&lt;a href=&quot;#KVO-Compliance&quot; class=&quot;headerlink&quot; title=&quot;KVO Compliance&quot;&gt;&lt;/a&gt;KVO Compliance&lt;/h2&gt;&lt;p&gt;æœ‰ä¸¤ç§æ–¹å¼èƒ½å¤Ÿä¿è¯ change notification èƒ½å¤Ÿè¢«å‘å‡ºã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨é€šçŸ¥ï¼Œç»§æ‰¿è‡ªNSObjectï¼Œå¹¶ä¸”æ‰€æœ‰çš„å±æ€§ç¬¦åˆ&lt;a href=&quot;file:///Users/hcy/Library/Developer/Shared/Documentation/DocSets/com.apple.adc.documentation.iOS.docset/Contents/Resources/Documents/documentation/Cocoa/Conceptual/KeyValueCoding/Articles/Compliant.html#//apple_ref/doc/uid/20002172&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;KVCè§„èŒƒ&lt;/a&gt;è¿™æ ·å°±ä¸ç”¨å†™é¢å¤–çš„ä»£ç å»å®ç°è‡ªåŠ¨é€šçŸ¥ã€‚&lt;/li&gt;
&lt;li&gt;æ‰‹åŠ¨é€šçŸ¥ï¼Œè®©ä½ çš„å­ç±»å®ç° &lt;code&gt;automaticallyNotifiesObserversForKey:&lt;/code&gt; æ–¹æ³•ï¼Œæ¥å†³å®šæ˜¯å¦éœ€è¦è‡ªåŠ¨é€šçŸ¥ï¼Œå¦‚æœæ˜¯æ‰‹åŠ¨é€šçŸ¥éœ€è¦é¢å¤–çš„ä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;è‡ªåŠ¨é€šçŸ¥&quot;&gt;&lt;a href=&quot;#è‡ªåŠ¨é€šçŸ¥&quot; class=&quot;headerlink&quot; title=&quot;è‡ªåŠ¨é€šçŸ¥&quot;&gt;&lt;/a&gt;è‡ªåŠ¨é€šçŸ¥&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt; NSObject å·²ç»å®ç°äº†è‡ªåŠ¨é€šçŸ¥ï¼Œåªè¦é€šè¿‡ setter æ–¹æ³•å»èµ‹å€¼ï¼Œæˆ–è€…é€šè¿‡ KVC å°±å¯ä»¥é€šçŸ¥åˆ°è§‚å¯Ÿè€…ã€‚è‡ªåŠ¨é€šçŸ¥ä¹Ÿæ”¯æŒé›†åˆä»£ç†å¯¹è±¡ï¼Œæ¯”å¦‚ mutableArrayValueForKey: æ–¹æ³•ã€‚&lt;/p&gt;
 &lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;comment&quot;&gt;// Call the accessor method.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[account setName:&lt;span class=&quot;string&quot;&gt;@&quot;Savings&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Use setValue:forKey:.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[account setValue:&lt;span class=&quot;string&quot;&gt;@&quot;Savings&quot;&lt;/span&gt; forKey:&lt;span class=&quot;string&quot;&gt;@&quot;name&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Use a key path, where &#39;account&#39; is a kvc-compliant property of &#39;document&#39;.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[document setValue:&lt;span class=&quot;string&quot;&gt;@&quot;Savings&quot;&lt;/span&gt; forKeyPath:&lt;span class=&quot;string&quot;&gt;@&quot;account.name&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Use mutableArrayValueForKey: to retrieve a relationship proxy object.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Transaction *newTransaction = &amp;lt;&lt;span class=&quot;meta&quot;&gt;#Create a new transaction for the account#&amp;gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSMutableArray&lt;/span&gt; *transactions = [account mutableArrayValueForKey:&lt;span class=&quot;string&quot;&gt;@&quot;transactions&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[transactions addObject:newTransaction];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;æ‰‹åŠ¨é€šçŸ¥&quot;&gt;&lt;a href=&quot;#æ‰‹åŠ¨é€šçŸ¥&quot; class=&quot;headerlink&quot; title=&quot;æ‰‹åŠ¨é€šçŸ¥&quot;&gt;&lt;/a&gt;æ‰‹åŠ¨é€šçŸ¥&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt; æ‰‹åŠ¨é€šçŸ¥æä¾›äº†æ›´è‡ªç”±çš„æ–¹å¼å»å†³å®šä»€ä¹ˆæ—¶é—´ï¼Œä»€ä¹ˆæ–¹å¼å»é€šçŸ¥è§‚å¯Ÿè€…ã€‚è¿™å¯ä»¥å¸®åŠ©ä½ æœ€å°‘é™åº¦è§¦å‘ä¸å¿…è¦çš„é€šçŸ¥ï¼Œæˆ–è€…ä¸€ç»„æ”¹å˜å€¼å‘å‡ºä¸€ä¸ªé€šçŸ¥ã€‚æƒ³è¦ä½¿ç”¨æ‰‹åŠ¨é€šçŸ¥å¿…é¡»å®ç°&lt;code&gt;automaticallyNotifiesObserversForKey:&lt;/code&gt; æ–¹æ³•ã€‚(æˆ–è€…&lt;code&gt;automaticallyNotifiesObserversOfS&amp;lt;Key&amp;gt;&lt;/code&gt;)åœ¨ä¸€ä¸ªç±»ä¸­åŒæ—¶ä½¿ç”¨è‡ªåŠ¨å’Œæ‰‹åŠ¨é€šçŸ¥æ˜¯å¯è¡Œçš„ã€‚å¯¹äºæƒ³è¦æ‰‹åŠ¨é€šçŸ¥çš„å±æ€§ï¼Œå¯ä»¥æ ¹æ®å®ƒçš„keyPathè¿”å›NOï¼Œè€Œå…¶å¯¹äºå…¶ä»–ä½ç½®çš„keyPathï¼Œè¦è¿”å›çˆ¶ç±»çš„è¿™ä¸ªæ–¹æ³•ã€‚&lt;/p&gt;
 &lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; + (&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt;)automaticallyNotifiesObserversForKey:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)theKey &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt; automatic = &lt;span class=&quot;literal&quot;&gt;NO&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([theKey isEqualToString:&lt;span class=&quot;string&quot;&gt;@&quot;openingBalance&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	    automatic = &lt;span class=&quot;literal&quot;&gt;NO&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   		&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     	    automatic = [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; automaticallyNotifiesObserversForKey:theKey];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   	 	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   	 	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; automatic;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt; è¦å®ç°æ‰‹åŠ¨é€šçŸ¥ï¼Œä½ éœ€è¦åœ¨å€¼æ”¹å˜å‰è°ƒç”¨ &lt;code&gt;willChangeValueForKey:&lt;/code&gt; æ–¹æ³•ï¼Œåœ¨å€¼æ”¹å˜åè°ƒç”¨ &lt;code&gt;didChangeValueForKey:&lt;/code&gt; æ–¹æ³•ã€‚ä½ å¯ä»¥åœ¨å‘é€é€šçŸ¥å‰æ£€æŸ¥å€¼æ˜¯å¦æ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰æ”¹å˜å°±ä¸å‘é€é€šçŸ¥&lt;/p&gt;
 &lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; - (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)setOpeningBalance:(&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;)theBalance &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (theBalance != _openingBalance) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       	 [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; willChangeValueForKey:&lt;span class=&quot;string&quot;&gt;@&quot;openingBalance&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       	 _openingBalance = theBalance;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       	 [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; didChangeValueForKey:&lt;span class=&quot;string&quot;&gt;@&quot;openingBalance&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   	 	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt; å¦‚æœä¸€ä¸ªæ“ä½œä¼šå¯¼è‡´å¤šä¸ªå±æ€§æ”¹å˜ï¼Œä½ éœ€è¦åµŒå¥—é€šçŸ¥ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š&lt;/p&gt;
 &lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; - (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)setOpeningBalance:(&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt;)theBalance &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; willChangeValueForKey:&lt;span class=&quot;string&quot;&gt;@&quot;openingBalance&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; willChangeValueForKey:&lt;span class=&quot;string&quot;&gt;@&quot;itemChanged&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   	 	_openingBalance = theBalance;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	_itemChanged = _itemChanged+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; didChangeValueForKey:&lt;span class=&quot;string&quot;&gt;@&quot;itemChanged&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; didChangeValueForKey:&lt;span class=&quot;string&quot;&gt;@&quot;openingBalance&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt; åœ¨ä¸€ä¸ªä¸€å¯¹å¤šçš„å…³ç³»ä¸­ï¼Œä½ å¿…é¡»æ³¨æ„ä¸ä»…ä»…æ˜¯è¿™ä¸ªkeyæ”¹å˜äº†ï¼Œè¿˜æœ‰å®ƒæ”¹å˜çš„ç±»å‹ä»¥åŠç´¢å¼•ã€‚&lt;/p&gt;
 &lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; - (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)removeTransactionsAtIndexes:(&lt;span class=&quot;built_in&quot;&gt;NSIndexSet&lt;/span&gt; *)indexes &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; willChange:&lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeRemoval&lt;/span&gt; valuesAtIndexes:indexes forKey:&lt;span class=&quot;string&quot;&gt;@&quot;transactions&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	   	&lt;span class=&quot;comment&quot;&gt;// Remove the transaction objects at the specified indexes.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; didChange:&lt;span class=&quot;built_in&quot;&gt;NSKeyValueChangeRemoval&lt;/span&gt; valuesAtIndexes:indexes forKey:&lt;span class=&quot;string&quot;&gt;@&quot;transactions&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;é”®ä¹‹é—´çš„ä¾èµ–&quot;&gt;&lt;a href=&quot;#é”®ä¹‹é—´çš„ä¾èµ–&quot; class=&quot;headerlink&quot; title=&quot;é”®ä¹‹é—´çš„ä¾èµ–&quot;&gt;&lt;/a&gt;é”®ä¹‹é—´çš„ä¾èµ–&lt;/h2&gt;&lt;p&gt;åœ¨å¾ˆå¤šç§æƒ…å†µä¸‹ä¸€ä¸ªå±æ€§çš„å€¼ä¾èµ–äºåœ¨å…¶ä»–å¯¹è±¡ä¸­çš„å±æ€§ã€‚å¦‚æœä¸€ä¸ªä¾èµ–å±æ€§çš„å€¼æ”¹å˜äº†ï¼Œè¿™ä¸ªå±æ€§ä¹Ÿéœ€è¦è¢«é€šçŸ¥åˆ°ã€‚&lt;/p&gt;
&lt;h3 id=&quot;To-one-Relationships&quot;&gt;&lt;a href=&quot;#To-one-Relationships&quot; class=&quot;headerlink&quot; title=&quot;To-one Relationships&quot;&gt;&lt;/a&gt;To-one Relationships&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;æ¯”å¦‚æœ‰ä¸€ä¸ªæ•™ &lt;code&gt;fullName&lt;/code&gt; çš„å±æ€§ï¼Œä¾èµ–äº &lt;code&gt;firstName&lt;/code&gt; å’Œ &lt;code&gt;lastName&lt;/code&gt;ï¼Œå½“ &lt;code&gt;firstName&lt;/code&gt; æˆ–è€… &lt;code&gt;lastName&lt;/code&gt; æ”¹å˜æ—¶ï¼Œè¿™ä¸ª &lt;code&gt;fullName&lt;/code&gt; å±æ€§éœ€è¦è¢«é€šçŸ¥åˆ°ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)fullName &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; stringWithFormat:&lt;span class=&quot;string&quot;&gt;@&quot;%@ %@&quot;&lt;/span&gt;,firstName, lastName];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½ å¯ä»¥é‡å†™ &lt;code&gt;keyPathsForValuesAffectingValueForKey:&lt;/code&gt; æ–¹æ³•ã€‚å…¶ä¸­è¦å…ˆè°ƒçˆ¶ç±»çš„è¿™ä¸ªæ–¹æ³•æ‹¿åˆ°ä¸€ä¸ªsetï¼Œå†åšæ¥ä¸‹æ¥çš„æ“ä½œã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;built_in&quot;&gt;NSSet&lt;/span&gt; *)keyPathsForValuesAffectingValueForKey:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)key &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSSet&lt;/span&gt; *keyPaths = [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; keyPathsForValuesAffectingValueForKey:key];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([key isEqualToString:&lt;span class=&quot;string&quot;&gt;@&quot;fullName&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;NSArray&lt;/span&gt; *affectingKeys = @[&lt;span class=&quot;string&quot;&gt;@&quot;lastName&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;@&quot;firstName&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        keyPaths = [keyPaths setByAddingObjectsFromArray:affectingKeys];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; keyPaths;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½ ä¹Ÿå¯ä»¥é€šè¿‡å®ç° &lt;code&gt;keyPathsForValuesAffecting&amp;lt;Key&amp;gt;&lt;/code&gt; æ–¹æ³•æ¥è¾¾åˆ°å‰é¢åŒæ ·çš„æ•ˆæœï¼Œè¿™é‡Œçš„&lt;key&gt;å°±æ˜¯å±æ€§åï¼Œä¸è¿‡ç¬¬ä¸€ä¸ªå­—æ¯è¦å¤§å†™ï¼Œç”¨å‰é¢çš„ä¾‹å­æ¥è¯´å°±æ˜¯è¿™æ ·ï¼š&lt;/key&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;built_in&quot;&gt;NSSet&lt;/span&gt; *)keyPathsForValuesAffectingFullName &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;built_in&quot;&gt;NSSet&lt;/span&gt; setWithObjects:&lt;span class=&quot;string&quot;&gt;@&quot;lastName&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;@&quot;firstName&quot;&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;To-many-Relationships&quot;&gt;&lt;a href=&quot;#To-many-Relationships&quot; class=&quot;headerlink&quot; title=&quot;To-many Relationships&quot;&gt;&lt;/a&gt;To-many Relationships&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;&lt;code&gt;keyPathsForValuesAffectingValueForKey:&lt;/code&gt;æ–¹æ³•ä¸èƒ½æ”¯æŒ to-many çš„å…³ç³»ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ä½ æœ‰ä¸€ä¸ª Department å¯¹è±¡ï¼Œå’Œå¾ˆå¤šä¸ª Employee å¯¹è±¡ã€‚è€Œ Employee æœ‰ä¸€ä¸ª salary å±æ€§ã€‚ä½ å¯èƒ½å¸Œæœ› Department å¯¹è±¡æœ‰ä¸€ä¸ª totalSalary çš„å±æ€§ï¼Œä¾èµ–äºæ‰€æœ‰çš„ Employee çš„ salary ã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥æ³¨å†Œ Department æˆä¸ºæ‰€æœ‰ Employee çš„è§‚å¯Ÿè€…ã€‚å½“ Employee è¢«æ·»åŠ æˆ–è€…è¢«ç§»é™¤æ—¶ï¼Œä½ å¿…é¡»è¦æ·»åŠ å’Œç§»é™¤è§‚å¯Ÿè€…ã€‚ç„¶ååœ¨ &lt;code&gt;observeValueForKeyPath:ofObject:change:context:&lt;/code&gt; æ–¹æ³•ä¸­ï¼Œæ ¹æ®æ”¹å˜åšå‡ºåé¦ˆã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)observeValueForKeyPath:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)keyPath ofObject:(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)object change:(&lt;span class=&quot;built_in&quot;&gt;NSDictionary&lt;/span&gt; *)change context:(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *)context &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (context == totalSalaryContext) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; updateTotalSalary];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// deal with other observations and/or invoke super...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)updateTotalSalary &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; setTotalSalary:[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; valueForKeyPath:&lt;span class=&quot;string&quot;&gt;@&quot;employees.@sum.salary&quot;&lt;/span&gt;]];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)setTotalSalary:(&lt;span class=&quot;built_in&quot;&gt;NSNumber&lt;/span&gt; *)newTotalSalary &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (totalSalary != newTotalSalary) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; willChangeValueForKey:&lt;span class=&quot;string&quot;&gt;@&quot;totalSalary&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _totalSalary = newTotalSalary;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; didChangeValueForKey:&lt;span class=&quot;string&quot;&gt;@&quot;totalSalary&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;NSNumber&lt;/span&gt; *)totalSalary &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; _totalSalary;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;KVOçš„å®ç°ç»†èŠ‚&quot;&gt;&lt;a href=&quot;#KVOçš„å®ç°ç»†èŠ‚&quot; class=&quot;headerlink&quot; title=&quot;KVOçš„å®ç°ç»†èŠ‚&quot;&gt;&lt;/a&gt;KVOçš„å®ç°ç»†èŠ‚&lt;/h2&gt;&lt;p&gt;KVO çš„å®ç°ç”¨äº†ä¸€ç§å« &lt;strong&gt;&lt;code&gt;isa-swizzling&lt;/code&gt;&lt;/strong&gt; çš„æŠ€æœ¯ã€‚isa æŒ‡é’ˆå°±æ˜¯æŒ‡å‘ç±»çš„æŒ‡é’ˆï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªå±æ€§æ³¨å†Œäº†è§‚å¯Ÿè€…åï¼Œè¢«è§‚å¯Ÿå¯¹è±¡çš„isaæŒ‡é’ˆçš„å°±æŒ‡å‘äº†ä¸€ä¸ªç³»ç»Ÿä¸ºæˆ‘ä»¬ç”Ÿæˆçš„ä¸­é—´ç±»ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„ç±»ã€‚åœ¨è¿™ä¸ªç±»ä¸­ï¼Œç³»ç»Ÿä¸ºæˆ‘ä»¬é‡å†™äº†è¢«è§‚å¯Ÿå±æ€§çš„setteræ–¹æ³•ã€‚ä½ å¯ä»¥é€šè¿‡ &lt;code&gt;object_getClass(id obj)&lt;/code&gt; æ–¹æ³•è·å¾—å¯¹è±¡çœŸå®çš„ç±»,åœ¨ addObserver å‰ååˆ†åˆ«æ‰“å°ï¼Œå°±å¯ä»¥çœ‹åˆ°isaæŒ‡é’ˆè¢«æŒ‡å‘äº†ä¸€ä¸ªä¸­é—´ç±»ã€‚ä¼¼ä¹éƒ½æ˜¯åœ¨åŸæ¥çš„ç±»åå‰é¢åŠ ä¸Š &lt;code&gt;NSKVONotifying_&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;isaæŒ‡é’ˆä¸æ€»æ˜¯æŒ‡å‘çœŸå®çš„ç±»ï¼Œæ‰€ä»¥ä½ ä¸åº”è¯¥ä¾èµ–äº isa æŒ‡é’ˆæ¥åˆ¤æ–­è¿™ä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œè€Œåº”è¯¥é€šè¿‡ &lt;code&gt;class&lt;/code&gt; æ–¹æ³•æ¥åˆ¤æ–­å¯¹è±¡çš„ç±»å‹ã€‚å¦‚æœä½ è¿˜ä¸çŸ¥é“ä»€ä¹ˆæ˜¯isaæŒ‡é’ˆï¼Œå¯ä»¥çœ‹æˆ‘ä¹‹å‰å†™çš„åšå®¢ &lt;a href=&quot;http://blog.cyrusdev.com/2016/03/10/Objective-C-runtime-%E7%9A%84%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3%E4%B8%8E%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%80%EF%BC%89/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Objective-C runtime çš„ç®€å•ç†è§£ä¸ä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/heading-KVO.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦å†…å®¹æ¥è‡ªäºå¯¹å®˜æ–¹æ–‡æ¡£ &lt;a href=&quot;https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html#//apple_ref/doc/uid/10000177-BCICJDHA&quot;&gt;Key-Value Observing Programming Guide&lt;/a&gt; çš„ç¿»è¯‘ï¼Œä»¥åŠä¸€éƒ¨åˆ†æˆ‘è‡ªå·±çš„ç†è§£å’Œè§£é‡Šï¼Œå¦‚æœæœ‰è¯´é”™çš„åœ°æ–¹è¯·åŠæ—¶è”ç³»æˆ‘ã€‚&lt;/p&gt;
&lt;h2 id=&quot;At-a-Glance&quot;&gt;&lt;a href=&quot;#At-a-Glance&quot; class=&quot;headerlink&quot; title=&quot;At a Glance&quot;&gt;&lt;/a&gt;At a Glance&lt;/h2&gt;&lt;p&gt;KVO ä¹Ÿå°±æ˜¯ é”®å€¼è§‚å¯Ÿ ï¼Œå®ƒæä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œä½¿å¾—å½“æŸä¸ªå¯¹è±¡ç‰¹å®šçš„å±æ€§å‘ç”Ÿæ”¹å˜æ—¶èƒ½å¤Ÿé€šçŸ¥åˆ°åˆ«çš„å¯¹è±¡ã€‚è¿™ç»å¸¸ç”¨äº model å’Œ controller ä¹‹é—´çš„é€šä¿¡ã€‚KVOä¸»è¦çš„ä¼˜ç‚¹æ˜¯ä½ ä¸éœ€è¦åœ¨æ¯æ¬¡å±æ€§æ”¹å˜æ—¶æ‰‹åŠ¨å»å‘é€é€šçŸ¥ã€‚å¹¶ä¸”å®ƒæ”¯æŒä¸ºä¸€ä¸ªå±æ€§æ³¨å†Œå¤šä¸ªè§‚å¯Ÿè€…ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ³¨å†Œ-KVO&quot;&gt;&lt;a href=&quot;#æ³¨å†Œ-KVO&quot; class=&quot;headerlink&quot; title=&quot;æ³¨å†Œ KVO&quot;&gt;&lt;/a&gt;æ³¨å†Œ KVO&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¢«è§‚å¯Ÿå¯¹è±¡&lt;/strong&gt; çš„å±æ€§å¿…é¡»æ˜¯ &lt;a href=&quot;file:///Users/hcy/Library/Developer/Shared/Documentation/DocSets/com.apple.adc.documentation.iOS.docset/Contents/Resources/Documents/documentation/Cocoa/Conceptual/KeyValueObserving/Articles/KVOCompliance.html#//apple_ref/doc/uid/20002178-BAJEAIEE&quot;&gt;KVO Compliant&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¿…é¡»ç”¨ &lt;strong&gt;è¢«è§‚å¯Ÿå¯¹è±¡&lt;/strong&gt; çš„ &lt;code&gt;addObserver:forKeyPath:options:context:&lt;/code&gt; æ–¹æ³•æ³¨å†Œè§‚å¯Ÿè€…&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§‚å¯Ÿè€…&lt;/strong&gt; å¿…é¡»å®ç° &lt;code&gt;observeValueForKeyPath:ofObject:change:context:&lt;/code&gt; æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="KVO" scheme="http://yoursite.com/tags/KVO/"/>
    
  </entry>
  
  <entry>
    <title>iOS è½¬åœºæ—¶ appear ä¸ disappear çš„è°ƒç”¨é¡ºåºæ¢ç´¢</title>
    <link href="http://yoursite.com/2016/04/06/iOS-%E8%BD%AC%E5%9C%BA%E6%97%B6-appear-%E4%B8%8E-disappear-%E7%9A%84%E8%B0%83%E7%94%A8%E9%A1%BA%E5%BA%8F%E6%8E%A2%E7%B4%A2/"/>
    <id>http://yoursite.com/2016/04/06/iOS-è½¬åœºæ—¶-appear-ä¸-disappear-çš„è°ƒç”¨é¡ºåºæ¢ç´¢/</id>
    <published>2016-04-06T13:41:52.000Z</published>
    <updated>2016-04-06T13:43:16.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/heading-Appear&amp;Disappear.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ€è¿‘å‡ å¤©çœ‹äº†å¥½å¤šäººçš„é¢ç»ï¼Œæ—¶ä¸æ—¶å°±çœ‹åˆ°ä¸€ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨Aé¡µé¢è·³è½¬åˆ°Bé¡µé¢çš„è¿‡ç¨‹ä¸­ A çš„ viewDidDisappear æ–¹æ³•å’Œ B çš„ viewDidAppear è°å…ˆè°ƒç”¨ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…¶å®æˆ‘ä»¥å‰ä¸€ç›´ç†æ‰€å½“ç„¶çš„è®¤ä¸ºå®ƒä»¬çš„é¡ºåºå°±æ˜¯ &lt;code&gt;A-viewDidDisappear&lt;/code&gt;  â€“&amp;gt; &lt;code&gt;B-viewDidAppear&lt;/code&gt;ï¼Œè‡³äºä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆæƒ³ï¼Œå°±æ˜¯æ„Ÿè§‰&lt;img src=&quot;http://7xs81e.com1.z0.glb.clouddn.com/%E4%B8%80%E8%84%B8%E6%87%B5%E9%80%BC.png&quot; ,=&quot;&quot; width=&quot;40&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä»Šå¤©å†™äº†ä¸ªDemoå»æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å®Œå…¨ä¸æ˜¯è‡ªå·±æƒ³è±¡çš„é‚£æ ·ï¼Œæ¯ä¸€ç§è½¬åœº(Push,Presentï¼ŒTabBaråˆ‡æ¢)éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/Hcy91425/Demo/tree/master/Appear%26Disappear-Sample&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Demo åœ°å€ Appear&amp;amp;Disappear-Sample&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;æµ‹è¯•&quot;&gt;&lt;a href=&quot;#æµ‹è¯•&quot; class=&quot;headerlink&quot; title=&quot;æµ‹è¯•&quot;&gt;&lt;/a&gt;æµ‹è¯•&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;æˆ‘è‡ªå®šä¹‰äº†ä¸¤ä¸ªç±»ï¼Œç»§æ‰¿è‡ªUIViewControllerï¼Œä¸ºäº†æ–¹ä¾¿è§‚å¯Ÿåˆ†åˆ«å«åš&lt;code&gt;A_ViewController&lt;/code&gt;,&lt;code&gt;B_ViewController&lt;/code&gt;ï¼Œç„¶åé‡å†™äº†ä¸€ç³»åˆ— &lt;code&gt;appear&lt;/code&gt; å’Œ &lt;code&gt;disappear&lt;/code&gt; æ–¹æ³•ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewWillAppear:(&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt;)animated &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewWillAppear:animated];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;A  view will appear    %@&quot;&lt;/span&gt;,&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewDidAppear:(&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt;)animated &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewDidAppear:animated];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;A  view did  appear    %@&quot;&lt;/span&gt;,&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewWillDisappear:(&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt;)animated &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewWillDisappear:animated];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;A  view will disappear %@&quot;&lt;/span&gt;,&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewDidDisappear:(&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt;)animated &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewDidDisappear: animated];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;A  view did  disappear %@&quot;&lt;/span&gt;,&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶ååˆ†åˆ«ç”¨ pushï¼Œ presentï¼Œ ä»¥åŠ tabbar çš„åˆ‡æ¢æ¥æµ‹è¯•ï¼Œç„¶åæŸ¥çœ‹æ‰“å°çš„ç»“æœã€‚&lt;/p&gt;
&lt;h3 id=&quot;Push-amp-Pop&quot;&gt;&lt;a href=&quot;#Push-amp-Pop&quot; class=&quot;headerlink&quot; title=&quot;Push &amp;amp; Pop&quot;&gt;&lt;/a&gt;Push &amp;amp; Pop&lt;/h3&gt;&lt;hr&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;--------------------------PUSH-----------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; A  view will disappear &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fa11067a730&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view will appear    &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fa110516530&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; A  view did  disappear &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fa11067a730&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view did  appear    &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fa110516530&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------------------POP-----------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view will disappear &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fa110516530&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; A  view will appear    &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fa11067a730&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view did  disappear &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fa110516530&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; A  view did  appear    &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fa11067a730&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨è¿™é‡Œçš„è°ƒç”¨é¡ºåºæ˜¯å’Œæˆ‘ä¹‹å‰é¢„æƒ³çš„ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯ &lt;/p&gt;
&lt;p&gt;&lt;code&gt;A-willDisappear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;B-willAppear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;A-didDisappear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;B-didAppear&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;Present-amp-Dismiss&quot;&gt;&lt;a href=&quot;#Present-amp-Dismiss&quot; class=&quot;headerlink&quot; title=&quot;Present &amp;amp; Dismiss&quot;&gt;&lt;/a&gt;Present &amp;amp; Dismiss&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;åœ¨æ¨¡æ€çš„è½¬åœºä¸­å°±æœ‰ä¸€äº›ä¸ä¸€æ ·çš„äº‹äº†ã€‚æˆ‘ä»¬çŸ¥é“æ¨¡æ€è½¬åœºæœ‰å¥½å¤šç§styleï¼Œå…¶ä¸­æœ‰ä¸¤ç§æˆ‘ä»¬éœ€è¦ç‰¹åˆ«æ³¨æ„çš„&lt;code&gt;UIModalPresentationCustom&lt;/code&gt;,&lt;code&gt;UIModalPresentationOverFullScreen&lt;/code&gt;ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹é™¤äº†è¿™ä¸¤ç§styleä»¥å¤–çš„è½¬åœºï¼Œä»–ä»¬çš„è°ƒç”¨é¡ºåºæ˜¯æ€æ ·çš„ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-----------------------NormalPresent------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; A  view will disappear &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fc2a14ac490&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view will appear    &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fc2a152a880&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view did  appear    &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fc2a152a880&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; A  view did  disappear &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fc2a14ac490&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-------------------------DISMISS----------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view will disappear &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fc2a152a880&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; A  view will appear    &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fc2a14ac490&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; A  view did  appear    &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fc2a14ac490&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view did  disappear &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7fc2a152a880&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿™é‡Œå…¶å®å·²ç»å’Œpushçš„è½¬åœºä¸ä¸€æ ·äº†ã€‚æ™®é€šæ¨¡æ€çš„è½¬åœºçš„é¡ºåºæ˜¯è¿™æ ·çš„&lt;/p&gt;
&lt;p&gt;&lt;code&gt;A-willDisappear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;B-willAppear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;B-didAppear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;A-didDisappear&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å†çœ‹çœ‹å‰é¢æåˆ°çš„é‚£ä¸¤ç§ç‰¹æ®Šçš„æ¨¡æ€è½¬åœºã€‚å› ä¸ºåœ¨è¿™ä¸¤ç§æ–¹å¼çš„è½¬åœºä¸‹Açš„viewæ˜¯ä¸ä¼šæ¶ˆå¤±çš„ï¼Œæ‰€ä»¥æ‰€æœ‰ä¸Aæœ‰å…³çš„ appear æˆ– disappear æ–¹æ³•éƒ½ä¸ä¼šè¢«è°ƒç”¨&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-----------------------CustomPresent------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view will appear    &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7f960249bac0&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view did  appear    &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7f960249bac0&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-------------------------DISMISS----------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view will disappear &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7f960249bac0&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; B  view did  disappear &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7f960249bac0&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ‰€ä»¥åœ¨è¿™ä¸¤ç§styleä¸‹åªæœ‰&lt;code&gt;B-willAppear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;B-didAppear&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;TabBaråˆ‡æ¢&quot;&gt;&lt;a href=&quot;#TabBaråˆ‡æ¢&quot; class=&quot;headerlink&quot; title=&quot;TabBaråˆ‡æ¢&quot;&gt;&lt;/a&gt;TabBaråˆ‡æ¢&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;TabBar çš„åˆ‡æ¢ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆç¥å¥‡çš„é¡ºåº&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;B  view will appear    &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7f88cbed7160&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;A  view will disappear &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7f88cbed6680&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;A  view did  disappear &amp;lt;A_ViewController: &lt;span class=&quot;number&quot;&gt;0x7f88cbed6680&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;B  view did  appear    &amp;lt;B_ViewController: &lt;span class=&quot;number&quot;&gt;0x7f88cbed7160&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸pushä¸åŒçš„æ˜¯ï¼ŒTabBarä¸‹ï¼Œä¼šå…ˆè°ƒç”¨ B çš„ willAppearï¼Œå†è°ƒç”¨ A çš„ willDisappear&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥TabBarçš„é¡ºåºæ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;B-willAppear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;A-willDisappear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;A-didDisappear&lt;/code&gt; â€“&amp;gt; &lt;code&gt;B-didAppear&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;æ€»ç»“&quot;&gt;&lt;a href=&quot;#æ€»ç»“&quot; class=&quot;headerlink&quot; title=&quot;æ€»ç»“&quot;&gt;&lt;/a&gt;æ€»ç»“&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;åœ¨æ¯ä¸€ç§è½¬åœºä¸‹ï¼Œappear ä¸ disappear éƒ½æœ‰ä¸€äº›ä¸ä¸€æ ·çš„é¡ºåºï¼Œä¸€å®šè¦åˆ†æ¸…æ¥šï¼Œä¸èƒ½ä¸€æ¦‚è€Œè®ºã€‚&lt;/p&gt;
&lt;p&gt;Pushï¼š &lt;code&gt;A-willDisappear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;B-willAppear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;A-didDisappear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;B-didAppear&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Presentï¼š &lt;code&gt;A-willDisappear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;B-willAppear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;B-didAppear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;A-didDisappear&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;CustomPresentï¼š &lt;code&gt;B-willAppear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;B-didAppear&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;TabBarï¼š &lt;code&gt;B-willAppear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;A-willDisappear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;A-didDisappear&lt;/code&gt;â€“&amp;gt;&lt;code&gt;B-didAppear&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;ç–‘æƒ‘&quot;&gt;&lt;a href=&quot;#ç–‘æƒ‘&quot; class=&quot;headerlink&quot; title=&quot;ç–‘æƒ‘&quot;&gt;&lt;/a&gt;ç–‘æƒ‘&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¦æŠŠè¿™ä¸ªè¿‡ç¨‹å¼„çš„è¿™ä¹ˆå¤æ‚ï¼Ÿç›®å‰è¿˜æ²¡æœ‰æƒ³æ³•ï¼Œå¦‚æœæœ‰çŸ¥é“çš„æœ‹å‹ï¼Œå¸Œæœ›å‘ŠçŸ¥ã€‚&lt;img src=&quot;http://7xs81e.com1.z0.glb.clouddn.com/%E4%B8%80%E8%84%B8%E6%87%B5%E9%80%BC.png&quot; ,=&quot;&quot; width=&quot;40&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src = &quot;http://7xrpns.com1.z0.glb.clouddn.com/heading-Appear&amp;Disappear.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ€è¿‘å‡ å¤©çœ‹äº†å¥½å¤šäººçš„é¢ç»ï¼Œæ—¶ä¸æ—¶å°±çœ‹åˆ°ä¸€ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨Aé¡µé¢è·³è½¬åˆ°Bé¡µé¢çš„è¿‡ç¨‹ä¸­ A çš„ viewDidDisappear æ–¹æ³•å’Œ B çš„ viewDidAppear è°å…ˆè°ƒç”¨ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…¶å®æˆ‘ä»¥å‰ä¸€ç›´ç†æ‰€å½“ç„¶çš„è®¤ä¸ºå®ƒä»¬çš„é¡ºåºå°±æ˜¯ &lt;code&gt;A-viewDidDisappear&lt;/code&gt;  â€“&amp;gt; &lt;code&gt;B-viewDidAppear&lt;/code&gt;ï¼Œè‡³äºä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆæƒ³ï¼Œå°±æ˜¯æ„Ÿè§‰&lt;img src=&quot;http://7xs81e.com1.z0.glb.clouddn.com/%E4%B8%80%E8%84%B8%E6%87%B5%E9%80%BC.png&quot;, width = 40&gt;&lt;/p&gt;
&lt;p&gt;ä»Šå¤©å†™äº†ä¸ªDemoå»æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å®Œå…¨ä¸æ˜¯è‡ªå·±æƒ³è±¡çš„é‚£æ ·ï¼Œæ¯ä¸€ç§è½¬åœº(Push,Presentï¼ŒTabBaråˆ‡æ¢)éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/Hcy91425/Demo/tree/master/Appear%26Disappear-Sample&quot;&gt;Demo åœ°å€ Appear&amp;amp;Disappear-Sample&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="UIKit å­¦ä¹ " scheme="http://yoursite.com/categories/UIKit-%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="viewDidAppear" scheme="http://yoursite.com/tags/viewDidAppear/"/>
    
  </entry>
  
  <entry>
    <title>åˆæ¬¡æ¥è§¦ RunLoop</title>
    <link href="http://yoursite.com/2016/03/24/%E5%88%9D%E6%AC%A1%E6%8E%A5%E8%A7%A6-RunLoop/"/>
    <id>http://yoursite.com/2016/03/24/åˆæ¬¡æ¥è§¦-RunLoop/</id>
    <published>2016-03-24T03:24:25.000Z</published>
    <updated>2016-03-24T03:26:09.000Z</updated>
    
    <content type="html">&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/heading-RunLoop.png&quot;&gt;&lt;/div&gt;

&lt;p&gt;æœ€è¿‘çœ‹äº†ä¸¤ä½å¤§ç¥å…³äºRunLoopçš„ä¸€äº›èµ„æ–™ï¼Œå¯¹RunLoopç®—æ˜¯æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†ï¼Œåœ¨è¿™é‡Œæ•´ç†æ€»ç»“ä¸€ä¸‹è‡ªå·±å¯¹äºRunLoopçš„ç†è§£ã€‚å¦‚æœæˆ‘æœ‰ç†è§£é”™çš„åœ°æ–¹ï¼Œå¸Œæœ›å¤§å®¶å¸®æˆ‘æŒ‡å‡ºã€‚æˆ‘çœ‹çš„æ˜¯ &lt;a href=&quot;http://weibo.com/239801242&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;@ibireme&lt;/a&gt; çš„åšå®¢å’Œ &lt;a href=&quot;http://weibo.com/u/1364395395&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;@æˆ‘å°±å«Sunnyæ€ä¹ˆäº†&lt;/a&gt; çš„è§†é¢‘ï¼Œé“¾æ¥åœ¨ä¸‹é¢ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://blog.ibireme.com/2015/05/18/runloop/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;æ·±å…¥ç†è§£RunLoop&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://v.youku.com/v_show/id_XODgxODkzODI0.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iOSçº¿ä¸‹åˆ†äº«ã€ŠRunLoopã€‹by å­™æº@sunnyxx&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯RunLoop&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯RunLoop&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯RunLoop&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯RunLoop&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;è¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œèƒ½å¤Ÿè®©æ•´ä¸ªç¨‹åºä¸€ç›´è¿è¡Œç€ä¸ä¼šé€€å‡ºï¼Œæ¥æ”¶ç”¨æˆ·çš„ä¿¡æ¯ã€‚å½“ç„¶è¿™ä¸ªå¾ªç¯æ˜¯ä¸€ä¸ªååˆ†å¤æ‚çš„å¾ªç¯ã€‚&lt;/p&gt;
&lt;h2 id=&quot;RunLoopä¸çº¿ç¨‹çš„å…³ç³»&quot;&gt;&lt;a href=&quot;#RunLoopä¸çº¿ç¨‹çš„å…³ç³»&quot; class=&quot;headerlink&quot; title=&quot;RunLoopä¸çº¿ç¨‹çš„å…³ç³»&quot;&gt;&lt;/a&gt;RunLoopä¸çº¿ç¨‹çš„å…³ç³»&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;æ¯ä¸ªçº¿ç¨‹æœ‰ä¸€ä¸ªè‡ªå·±çš„mainå‡½æ•°ï¼Œå½“è¿™ä¸ªmainå‡½æ•°æ‰§è¡Œå®Œåè¿™ä¸ªçº¿ç¨‹ä¹Ÿå°±æ²¡äº†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™è¿™ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ª RunLoopã€‚ä½†æ˜¯åœ¨çº¿ç¨‹åˆ›å»ºçš„æ—¶å€™å¹¶æ²¡æœ‰ RunLoop ï¼Œåªæœ‰å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡å»è·å–è¿™ä¸ªçº¿ç¨‹çš„ RunLoop æ—¶ï¼Œæ‰ä¼šåˆ›å»ºã€‚&lt;/p&gt;
&lt;h2 id=&quot;RunLoopçš„ç»“æ„&quot;&gt;&lt;a href=&quot;#RunLoopçš„ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;RunLoopçš„ç»“æ„&quot;&gt;&lt;/a&gt;RunLoopçš„ç»“æ„&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;æ¯ä¸ª RunLoop ä¸­æœ‰ä¸€ä¸ªé›†åˆå…¶ä¸­å­˜æ”¾äº†è‹¥å¹²ä¸ª Modeï¼Œä¸€ä¸ª RunLoop åªèƒ½åœ¨ä¸€ç§ Mode ä¸‹è¿è¡Œï¼Œå¦‚æœéœ€è¦åˆ‡æ¢é‚£ä¹ˆä¹…è¦é€€å‡º Loop å†é‡æ–°æŒ‡å®šä¸€ä¸ª Mode è¿›å…¥ã€‚æ¯ä¸ª Mode ä¸­åˆæœ‰è‹¥å¹²ä¸ª item ï¼Œæ€»å…±æœ‰ä¸‰ç±»ï¼Œåˆ†åˆ«æ˜¯ &lt;code&gt;Source&lt;/code&gt;,&lt;code&gt;Timer&lt;/code&gt;,&lt;code&gt;Observer&lt;/code&gt;ã€‚å…ˆè¯´ç®€å•çš„&lt;/p&gt;
&lt;h3 id=&quot;Timer&quot;&gt;&lt;a href=&quot;#Timer&quot; class=&quot;headerlink&quot; title=&quot;Timer&quot;&gt;&lt;/a&gt;Timer&lt;/h3&gt;&lt;p&gt;Timer å°±æ˜¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨ NSTimer ä¸å®ƒç´§å¯†ç›¸å…³ã€‚å®ƒåŒ…å«ä¸€ä¸ªæ—¶é—´é•¿åº¦å’Œä¸€ä¸ªä½œä¸ºå›è°ƒçš„å‡½æ•°æŒ‡é’ˆï¼Œå½“å®ƒåŠ å…¥åˆ° RunLoop åï¼Œæ¯æ¬¡åˆ°é‚£ä¸ªæ—¶é—´ç‚¹ï¼Œå°±ä¼šæ‰§è¡Œä¸€æ¬¡å›è°ƒã€‚&lt;/p&gt;
&lt;h3 id=&quot;Observer&quot;&gt;&lt;a href=&quot;#Observer&quot; class=&quot;headerlink&quot; title=&quot;Observer&quot;&gt;&lt;/a&gt;Observer&lt;/h3&gt;&lt;p&gt;Observer å°±æ˜¯è§‚å¯Ÿè€…ï¼Œå®ƒä¹ŸåŒ…å«ä¸€ä¸ªå›è°ƒï¼Œå½“ RunLoop çš„çŠ¶æ€æ”¹å˜æ—¶ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªå›è°ƒã€‚RunLoop æœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€:&lt;/p&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CF_OPTIONS&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(CFOptionFlags, CFRunLoopActivity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    kCFRunLoopEntry         = (&lt;span class=&quot;number&quot;&gt;1U&lt;/span&gt;L &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    kCFRunLoopBeforeTimers  = (&lt;span class=&quot;number&quot;&gt;1U&lt;/span&gt;L &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    kCFRunLoopBeforeSources = (&lt;span class=&quot;number&quot;&gt;1U&lt;/span&gt;L &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;), &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    kCFRunLoopBeforeWaiting = (&lt;span class=&quot;number&quot;&gt;1U&lt;/span&gt;L &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;), &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    kCFRunLoopAfterWaiting  = (&lt;span class=&quot;number&quot;&gt;1U&lt;/span&gt;L &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;), &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    kCFRunLoopExit          = (&lt;span class=&quot;number&quot;&gt;1U&lt;/span&gt;L &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;), &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Source&quot;&gt;&lt;a href=&quot;#Source&quot; class=&quot;headerlink&quot; title=&quot;Source&quot;&gt;&lt;/a&gt;Source&lt;/h3&gt;&lt;p&gt;Sourceå°±æ¯”è¾ƒéš¾ç†è§£äº†ã€‚åæ­£æˆ‘è‡ªå·±æ²¡æœ‰å¼„æ˜ç™½ï¼Œè¿˜æ˜¯å¼•ç”¨ä¸€ä¸‹&lt;a href=&quot;http://weibo.com/239801242&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;@ibireme&lt;/a&gt;çš„åŸè¯å§ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;CFRunLoopSourceRef æ˜¯äº‹ä»¶äº§ç”Ÿçš„åœ°æ–¹ã€‚Sourceæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼šSource0 å’Œ Source1ã€‚&lt;/p&gt;
&lt;p&gt;Source0 åªåŒ…å«äº†ä¸€ä¸ªå›è°ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ï¼Œå®ƒå¹¶ä¸èƒ½ä¸»åŠ¨è§¦å‘äº‹ä»¶ã€‚ä½¿ç”¨æ—¶ï¼Œä½ éœ€è¦å…ˆè°ƒç”¨ CFRunLoopSourceSignal(source)ï¼Œå°†è¿™ä¸ª Source æ ‡è®°ä¸ºå¾…å¤„ç†ï¼Œç„¶åæ‰‹åŠ¨è°ƒç”¨ CFRunLoopWakeUp(runloop) æ¥å”¤é†’ RunLoopï¼Œè®©å…¶å¤„ç†è¿™ä¸ªäº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;Source1 åŒ…å«äº†ä¸€ä¸ª mach_port å’Œä¸€ä¸ªå›è°ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ï¼Œè¢«ç”¨äºé€šè¿‡å†…æ ¸å’Œå…¶ä»–çº¿ç¨‹ç›¸äº’å‘é€æ¶ˆæ¯ã€‚è¿™ç§ Source èƒ½ä¸»åŠ¨å”¤é†’ RunLoop çš„çº¿ç¨‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;CFRunLoopMode-å’Œ-CFRunLoop-çš„ç»“æ„&quot;&gt;&lt;a href=&quot;#CFRunLoopMode-å’Œ-CFRunLoop-çš„ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;CFRunLoopMode å’Œ CFRunLoop çš„ç»“æ„&quot;&gt;&lt;/a&gt;CFRunLoopMode å’Œ CFRunLoop çš„ç»“æ„&lt;/h3&gt;&lt;p&gt;æˆ‘è§‰å¾—çœ‹äº†ä¸‹é¢è¿™ä¸¤ä¸ªç»“æ„ä½“åï¼Œå¯¹äº RunLoop çš„ç†è§£ä¼šæ˜æœ—å¾ˆå¤šã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; __CFRunLoopMode &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CFStringRef _name;            &lt;span class=&quot;comment&quot;&gt;// Mode Name&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CFMutableSetRef _sources0;    &lt;span class=&quot;comment&quot;&gt;// Set&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CFMutableSetRef _sources1;    &lt;span class=&quot;comment&quot;&gt;// Set&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CFMutableArrayRef _observers; &lt;span class=&quot;comment&quot;&gt;// Array&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CFMutableArrayRef _timers;    &lt;span class=&quot;comment&quot;&gt;// Array&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; __CFRunLoop &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CFMutableSetRef _commonModes;     &lt;span class=&quot;comment&quot;&gt;// Set&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CFMutableSetRef _commonModeItems; &lt;span class=&quot;comment&quot;&gt;// Set&amp;lt;Source/Observer/Timer&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CFRunLoopModeRef _currentMode;    &lt;span class=&quot;comment&quot;&gt;// Current Runloop Mode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CFMutableSetRef _modes;           &lt;span class=&quot;comment&quot;&gt;// Set&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;__CFRunLoop&lt;/code&gt; ä¸­æœ‰ä¸€ä¸ª &lt;code&gt;_modes&lt;/code&gt; ç”¨æ¥å­˜æ”¾è¿™ä¸ª RunLoop ä¸­çš„æ‰€æœ‰ Modeã€‚è¿˜æœ‰ä¸€ä¸ª &lt;code&gt;_currentMode&lt;/code&gt; ç”¨æ¥æ ‡è®°å½“å‰çš„ Modeã€‚è€Œåœ¨ &lt;code&gt;_CFRunLoopMode&lt;/code&gt; ä¸­é™¤äº† &lt;code&gt;_name&lt;/code&gt; å°±æ˜¯é‚£ä¸‰ç§ itemï¼Œåº”è¯¥å¾ˆå®¹æ˜“çœ‹å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦ä¸€æçš„æ˜¯åœ¨ &lt;code&gt;__CGRunLoop&lt;/code&gt; ä¸­æœ‰ &lt;code&gt;CFMutableSetRef _commonModes;&lt;/code&gt; &lt;code&gt;CFMutableSetRef _commonModeItems;&lt;/code&gt; è¿™ä¸ªä¸¤ä¸ªç»“æ„ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ª Mode æ ‡è®°ä¸º &lt;code&gt;Common&lt;/code&gt;ã€‚ è¿™æ ·æ¯æ¬¡ RunLoop å†…å®¹æ”¹å˜æ—¶éƒ½ä¼šæŠŠ _commonModeItems é‡Œçš„ items å…¨éƒ¨åŒæ­¥åˆ°æ ‡è®°äº† Common çš„ Mode ä¸­ã€‚åœ¨åé¢è®² timer çš„ä¾‹å­æ—¶æˆ‘ä»¬è¿˜ä¼šå†æåˆ°ã€‚&lt;/p&gt;
&lt;h3 id=&quot;RunLoop-çš„å†…éƒ¨é€»è¾‘&quot;&gt;&lt;a href=&quot;#RunLoop-çš„å†…éƒ¨é€»è¾‘&quot; class=&quot;headerlink&quot; title=&quot;RunLoop çš„å†…éƒ¨é€»è¾‘&quot;&gt;&lt;/a&gt;RunLoop çš„å†…éƒ¨é€»è¾‘&lt;/h3&gt;&lt;p&gt;è¿˜æ˜¯å¼•ç”¨ä¸€ä¸‹&lt;a href=&quot;http://weibo.com/239801242&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;@ibireme&lt;/a&gt;çš„å›¾ç‰‡ï¼Œååˆ†çš„ç›´è§‚æ˜äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/RunLoop_1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;RunLoop-åº”ç”¨&quot;&gt;&lt;a href=&quot;#RunLoop-åº”ç”¨&quot; class=&quot;headerlink&quot; title=&quot;RunLoop åº”ç”¨&quot;&gt;&lt;/a&gt;RunLoop åº”ç”¨&lt;/h2&gt;&lt;hr&gt;
&lt;h3 id=&quot;NSTimer&quot;&gt;&lt;a href=&quot;#NSTimer&quot; class=&quot;headerlink&quot; title=&quot;NSTimer&quot;&gt;&lt;/a&gt;NSTimer&lt;/h3&gt;&lt;p&gt;åœ¨æˆ‘åˆšåˆšå­¦ iOS çš„æ—¶å€™ï¼Œä¸€æ¬¡å¶ç„¶çŸ¥é“äº† NSTimer è¿™ä¸ªä¸œè¥¿åï¼Œé«˜å…´çš„ç”¨å®ƒæ¨¡ä»¿äº†ä¸€ä¸ªç³»ç»Ÿçš„è®¡æ—¶å™¨ã€‚æºç åœ¨ä¸€æ¬¡æ•´ç†çš„æ—¶å€™è¢«æˆ‘åˆ äº†ã€‚ã€‚åªèƒ½çœ‹çœ‹æˆªå›¾äº†ï¼š&lt;/p&gt;
&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/timer1.PNG&quot; ,=&quot;&quot; width=&quot;500&quot;&gt;&lt;/div&gt;

&lt;p&gt;æœ¬æ¥æŒºå¼€å¿ƒçš„ï¼Œç»“æœä¸€æ»šåŠ¨ä¸‹é¢çš„è¡¨æ ¼ï¼ŒWHATï¼Ÿï¼è®¡æ—¶å™¨æ€ä¹ˆä¸åŠ¨äº†ï¼Ÿï¼Ÿ &lt;img src=&quot;http://7xs81e.com1.z0.glb.clouddn.com/%E4%B8%80%E8%84%B8%E6%87%B5%E9%80%BC.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;åæ¥ä¹ŸæŸ¥äº†è§£å†³åŠæ³•ï¼Œä¸è¿‡ä¸€ç›´æ²¡ææ‡‚ä¸ºä»€ä¹ˆã€‚ç°åœ¨çŸ¥é“äº† RunLoop åæ€»ç®—æ˜¯æ˜ç™½äº†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸»çº¿ç¨‹ä¸­æœ‰é¢„ç½®ä¸¤ä¸ª Modeï¼Œä¸€ä¸ªæ˜¯ Defaultï¼Œè¿˜æœ‰ä¸€ä¸ªå°±æ˜¯ UITrackingRunLoopModeï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªModeéƒ½æ ‡è®°äº† Commonã€‚è¿™ä¸ª Mode åœ¨ ScrollView æ»šåŠ¨æ—¶ä¼šåˆ‡æ¢ï¼Œç”¨æ¥ä¿è¯æ»šåŠ¨çš„æµç•…ã€‚è€Œæˆ‘ä»¬æ³¨å†Œ timer ä½¿ç”¨çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;_timer = [&lt;span class=&quot;built_in&quot;&gt;NSTimer&lt;/span&gt; scheduledTimerWithTimeInterval:&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt; target:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; selector:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(timerAction) userInfo:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt; repeats:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¼šé»˜è®¤æŠŠè¿™ä¸ª timer æ³¨å†Œåˆ°å½“å‰ RunLoop çš„ DefaultMode ä¸­ï¼Œé‚£ä¹ˆæ»šåŠ¨çš„æ—¶å€™ Mode ä¸€åˆ‡æ¢ timer å¾ˆæ˜¾ç„¶å°±æ²¡æ³•å·¥ä½œäº†ã€‚è§£å†³åŠæ³•ä¹Ÿå¾ˆå®¹æ˜“ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æŠŠtimeræ³¨å†Œåˆ°&lt;code&gt;UITrackingRunLoopMode&lt;/code&gt;æˆ–è€…&lt;code&gt;NSRunLoopCommonModes&lt;/code&gt;(æ·»åŠ åˆ° CommonModes ä¸­å°±ç›¸å½“äºè‡ªåŠ¨æ·»åŠ åˆ°äº†&lt;code&gt;UITrackingRunLoopMode&lt;/code&gt;)ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// äºŒé€‰ä¸€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[[&lt;span class=&quot;built_in&quot;&gt;NSRunLoop&lt;/span&gt; currentRunLoop] addTimer:_timer forMode:&lt;span class=&quot;built_in&quot;&gt;UITrackingRunLoopMode&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[[&lt;span class=&quot;built_in&quot;&gt;NSRunLoop&lt;/span&gt; currentRunLoop] addTimer:_timer forMode:&lt;span class=&quot;built_in&quot;&gt;NSRunLoopCommonModes&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŠŠtimeræ·»åŠ åˆ°å­çº¿ç¨‹çš„ RunLoop ä¸­ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆModeéƒ½ä¸ä¼šå½±å“åˆ°ä¸»çº¿ç¨‹&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;dispatch_queue_t&lt;/span&gt; queue = dispatch_queue_create(&lt;span class=&quot;string&quot;&gt;&quot;com.cyrusdev.queue&quot;&lt;/span&gt;, DISPATCH_QUEUE_CONCURRENT);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;built_in&quot;&gt;dispatch_async&lt;/span&gt;(queue, ^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       _timer = [&lt;span class=&quot;built_in&quot;&gt;NSTimer&lt;/span&gt; scheduledTimerWithTimeInterval:&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt; target:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; selector:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(timerAction) userInfo:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt; repeats:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       [[&lt;span class=&quot;built_in&quot;&gt;NSRunLoop&lt;/span&gt; currentRunLoop] run]; &lt;span class=&quot;comment&quot;&gt;// ä¸€å®šè¦åœ¨æ³¨å†Œtimerä¹‹åè®© RunLoop è·‘èµ·æ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘å†™äº†ä¸€ä¸ªDemoï¼Œåœ°å€åœ¨è¿™é‡Œï¼Œå¯ä»¥æ„Ÿå—ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/Hcy91425/Demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RunLoopDemo&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;AutoreleasePool&quot;&gt;&lt;a href=&quot;#AutoreleasePool&quot; class=&quot;headerlink&quot; title=&quot;AutoreleasePool&quot;&gt;&lt;/a&gt;AutoreleasePool&lt;/h3&gt;&lt;p&gt;åœ¨ App å¯åŠ¨åï¼Œç³»ç»Ÿä¼šåœ¨ä¸»çº¿ç¨‹çš„ RunLoop é‡Œæ³¨å†Œä¸¤ä¸ª Observerã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ª Observer ç›‘å¬ &lt;code&gt;kCFRunLoopEntry&lt;/code&gt; ä¹Ÿå°±æ˜¯å³å°†è¿›å…¥ RunLoop çš„çŠ¶æ€ï¼Œåœ¨è¿™é‡Œä¼šåˆ›å»ºä¸€ä¸ªè‡ªåŠ¨é‡Šæ”¾æ± ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒä¸ª Observer ç›‘å¬ &lt;code&gt;kCFRunLoopBeforeWaiting&lt;/code&gt; ä»¥åŠ &lt;code&gt;kCFRunLoopExit&lt;/code&gt; ä¸¤ä¸ªçŠ¶æ€ã€‚åœ¨ RunLoop å³å°†è¿›å…¥ä¼‘çœ æ—¶é‡Šæ”¾æ—§æ± ï¼Œåˆ›å»ºæ–°æ± ã€‚åœ¨ RunLoop è¦é€€å‡ºæ—¶é‡Šæ”¾æ± å­ã€‚&lt;/p&gt;
&lt;h3 id=&quot;è®©ä¸€ä¸ªå­çº¿ç¨‹ä¸€ç›´è¿è¡Œ&quot;&gt;&lt;a href=&quot;#è®©ä¸€ä¸ªå­çº¿ç¨‹ä¸€ç›´è¿è¡Œ&quot; class=&quot;headerlink&quot; title=&quot;è®©ä¸€ä¸ªå­çº¿ç¨‹ä¸€ç›´è¿è¡Œ&quot;&gt;&lt;/a&gt;è®©ä¸€ä¸ªå­çº¿ç¨‹ä¸€ç›´è¿è¡Œ&lt;/h3&gt;&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewDidLoad &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewDidLoad];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;// åˆ›å»ºå­çº¿ç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.thread = [[&lt;span class=&quot;built_in&quot;&gt;NSThread&lt;/span&gt; alloc] initWithTarget:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; selector:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(threadMain) object:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.thread start];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)threadMain &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [[&lt;span class=&quot;built_in&quot;&gt;NSThread&lt;/span&gt; currentThread] setName:&lt;span class=&quot;string&quot;&gt;@&quot;myThread&quot;&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSRunLoop&lt;/span&gt; *runLoop = [&lt;span class=&quot;built_in&quot;&gt;NSRunLoop&lt;/span&gt; currentRunLoop];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [runLoop addPort:[&lt;span class=&quot;built_in&quot;&gt;NSMachPort&lt;/span&gt; port] forMode:&lt;span class=&quot;built_in&quot;&gt;NSDefaultRunLoopMode&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [runLoop run];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆ‘åœ¨ myThread çº¿ç¨‹ä¸­åˆ›å»ºäº†ä¸€ä¸ª RunLoopï¼Œè¿™ä¸ªçº¿ç¨‹å°±ä¸ä¼šè‡ªåŠ¨é”€æ¯äº†ã€‚æˆ‘ä»¬å¯ä»¥æš‚åœç¨‹åºçœ‹ä¸€ä¸‹å®ƒçš„çº¿ç¨‹å †æ ˆï¼š&lt;/p&gt;
&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/%E7%BA%BF%E7%A8%8B%E5%A0%86%E6%A0%88.png&quot; ,=&quot;&quot; width=&quot;500&quot;&gt;&lt;/div&gt;

&lt;h2 id=&quot;æ€»ç»“&quot;&gt;&lt;a href=&quot;#æ€»ç»“&quot; class=&quot;headerlink&quot; title=&quot;æ€»ç»“&quot;&gt;&lt;/a&gt;æ€»ç»“&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;å¯¹äº RunLoop çš„äº†è§£å…¶å®è¿˜å¾ˆæµ…ï¼Œåªèƒ½æœ‰ä¸€ä¸ªå¤§æ¦‚çš„ç»“æ„ï¼Œä¸è¿‡äº†è§£äº†è¿™äº›å†…å®¹å¯¹äºæ•´ä¸ªAppè¿è¡Œçš„è¿‡ç¨‹è¿˜æ˜¯ä¼šæ›´åŠ æ·±å…¥ä¸€äº›äº†ã€‚&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/heading-RunLoop.png&quot;&gt;&lt;/div&gt;

&lt;p&gt;æœ€è¿‘çœ‹äº†ä¸¤ä½å¤§ç¥å…³äºRunLoopçš„ä¸€äº›èµ„æ–™ï¼Œå¯¹RunLoopç®—æ˜¯æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†ï¼Œåœ¨è¿™é‡Œæ•´ç†æ€»ç»“ä¸€ä¸‹è‡ªå·±å¯¹äºRunLoopçš„ç†è§£ã€‚å¦‚æœæˆ‘æœ‰ç†è§£é”™çš„åœ°æ–¹ï¼Œå¸Œæœ›å¤§å®¶å¸®æˆ‘æŒ‡å‡ºã€‚æˆ‘çœ‹çš„æ˜¯ &lt;a href=&quot;http://weibo.com/239801242&quot;&gt;@ibireme&lt;/a&gt; çš„åšå®¢å’Œ &lt;a href=&quot;http://weibo.com/u/1364395395&quot;&gt;@æˆ‘å°±å«Sunnyæ€ä¹ˆäº†&lt;/a&gt; çš„è§†é¢‘ï¼Œé“¾æ¥åœ¨ä¸‹é¢ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://blog.ibireme.com/2015/05/18/runloop/&quot;&gt;æ·±å…¥ç†è§£RunLoop&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://v.youku.com/v_show/id_XODgxODkzODI0.html&quot;&gt;iOSçº¿ä¸‹åˆ†äº«ã€ŠRunLoopã€‹by å­™æº@sunnyxx&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="RunLoop" scheme="http://yoursite.com/tags/RunLoop/"/>
    
  </entry>
  
  <entry>
    <title>iOS è‡ªå®šä¹‰è½¬åœºåŠ¨ç”» åˆçª¥</title>
    <link href="http://yoursite.com/2016/03/18/iOS-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E5%9C%BA%E5%8A%A8%E7%94%BB-%E5%88%9D%E7%AA%A5/"/>
    <id>http://yoursite.com/2016/03/18/iOS-è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»-åˆçª¥/</id>
    <published>2016-03-18T08:55:42.000Z</published>
    <updated>2016-03-24T03:29:52.000Z</updated>
    
    <content type="html">&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/heading-customTransition.png&quot;&gt;&lt;/div&gt;

&lt;p&gt;è¿™ä¸¤å¤©å­¦ä¹ äº†ä¸€ä¸‹è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»çš„å†…å®¹ï¼Œåˆšå¼€å§‹çœ‹çš„æ—¶å€™è¢«è¿™å‡ ä¸ªåˆé•¿åˆå¾ˆç›¸ä¼¼çš„åè®®å¼„çš„æ™•å¤´è½¬å‘ï¼Œæ‰€ä»¥å¸Œæœ›èƒ½å†™ä¸€ç¯‡æµ…æ˜¾æ˜“æ‡‚çš„å…¥é—¨æ–‡ç« ã€‚æœ¬æ–‡çš„å†…å®¹ä¼šæ¯”è¾ƒåŸºç¡€ï¼Œä¸ä¼šæ¶‰åŠçš„å¾ˆæ·±çš„ï¼Œå°±åƒé¢˜ç›®è¯´çš„&lt;code&gt;åˆçª¥&lt;/code&gt;ã€‚é€šè¿‡æœ¬æ–‡å¯ä»¥ç”¨æœ€ç®€å•çš„æ–¹å¼å®ç°æœ€ç®€å•çš„è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ã€‚å¦‚æœä½ éœ€è¦æ›´åŠ æ·±å…¥çš„çŸ¥è¯†ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://developer.apple.com/library/prerelease/ios/featuredarticles/ViewControllerPGforiPhoneOS/CustomizingtheTransitionAnimations.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Customizing the Transition Animations&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;æœ¬æ–‡ä¸­çš„ Demo å¯ä»¥ä» &lt;a href=&quot;https://github.com/Hcy91425/Demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;è¿™é‡Œ&lt;/a&gt; ä¸‹è½½&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨è®²ä¸»è¦çš„å†…å®¹ä¹‹å‰æˆ‘ä»¬éœ€è¦åˆ†æ¸…å‡ ä¸ªæ¦‚å¿µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;presentingViewController&lt;/li&gt;
&lt;li&gt;presentedViewController&lt;/li&gt;
&lt;li&gt;fromViewController&lt;/li&gt;
&lt;li&gt;toViewController&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;presentingVC&lt;/code&gt;å’Œ&lt;code&gt;presentedVC&lt;/code&gt;çš„æ¦‚å¿µæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œå‰è€…å°±æ˜¯ &lt;strong&gt;æ‰§è¡Œpresent&lt;/strong&gt; åŠ¨ä½œçš„é‚£ä¸ªæ§åˆ¶å™¨ï¼Œè€Œåè€…å°±æ˜¯ &lt;strong&gt;è¢«present&lt;/strong&gt; çš„é‚£ä¸ªæ§åˆ¶å™¨ï¼Œè¿™ä¸¤ä¸ªæ§åˆ¶å™¨çš„èº«ä»½æ˜¯å§‹ç»ˆä¸ä¼šæ”¹å˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fromVC&lt;/code&gt;å’Œ&lt;code&gt;toVC&lt;/code&gt;æ˜¯ä¸ªç›¸å¯¹çš„æ¦‚å¿µï¼Œåœ¨æ‰§è¡Œ &lt;strong&gt;present&lt;/strong&gt; çš„æ—¶å€™&lt;code&gt;presentingVC&lt;/code&gt;å°±æ˜¯&lt;code&gt;fromVC&lt;/code&gt;ï¼Œè€Œ&lt;code&gt;presentedVC&lt;/code&gt;å°±æ˜¯&lt;code&gt;toVC&lt;/code&gt;ã€‚åœ¨ &lt;strong&gt;dismiss&lt;/strong&gt; çš„æ—¶å€™å°±è¦åä¸€åäº†&lt;code&gt;presentedVC&lt;/code&gt;æ˜¯&lt;code&gt;fromVC&lt;/code&gt;,è€Œ&lt;code&gt;presentingVC&lt;/code&gt;æ˜¯&lt;code&gt;toVC&lt;/code&gt;ã€‚å®˜æ–¹æœ‰ä¸€å¼ å›¾æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/from&amp;to.png&quot; width=&quot;400&quot;&gt;&lt;/div&gt;

&lt;h2 id=&quot;æ™®é€š-view-controller-è‡ªå®šä¹‰è½¬åœº&quot;&gt;&lt;a href=&quot;#æ™®é€š-view-controller-è‡ªå®šä¹‰è½¬åœº&quot; class=&quot;headerlink&quot; title=&quot;æ™®é€š view controller è‡ªå®šä¹‰è½¬åœº&quot;&gt;&lt;/a&gt;æ™®é€š view controller è‡ªå®šä¹‰è½¬åœº&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆä»¥æ™®é€šçš„ view controller ä¸ºä¾‹å­ï¼Œè®² present å’Œ dismiss çš„è½¬åœºã€‚å¾€ç®€å•äº†è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ 3 ä¸ªåè®®å°±å¯ä»¥å®ç°è‡ªå®šä¹‰è½¬åœºã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@protocol&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;UIViewControllerContextTransitioning&lt;/span&gt; &amp;lt;&lt;span class=&quot;title&quot;&gt;NSObject&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@protocol&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;UIViewControllerAnimatedTransitioning&lt;/span&gt; &amp;lt;&lt;span class=&quot;title&quot;&gt;NSObject&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@protocol&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;UIViewControllerTransitioningDelegate&lt;/span&gt; &amp;lt;&lt;span class=&quot;title&quot;&gt;NSObject&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªåè®®&lt;code&gt;UIViewControllerContextTransitioning&lt;/code&gt; å®ç°äº†è¿™ä¸ªåè®®çš„å¯¹è±¡ï¼Œæˆ‘å®ƒä¸º&lt;code&gt;è½¬åœºä¸Šä¸‹æ–‡&lt;/code&gt;ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè½¬åœºä¸Šä¸‹æ–‡ä¸ç”¨æˆ‘ä»¬è‡ªå·±å®ç°ï¼Œç”±ç³»ç»Ÿæä¾›ç»™æˆ‘ä»¬ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°å¾ˆå¤šè½¬åœºç›¸å…³çš„ä¿¡æ¯ã€‚è¿™é‡Œæˆ‘åªåˆ—ä¸¾å‡ ä¸ªé‡è¦çš„å±æ€§æˆ–æ–¹æ³•ï¼Œå…¶ä»–çš„çœ‹åå­—å’Œæ³¨é‡Šä¹Ÿèƒ½å¾ˆå®¹æ˜“çŸ¥é“å®ƒä»¬çš„ç”¨é€”ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// æ‰€æœ‰è¦æ‰§è¡ŒåŠ¨ç”»çš„ view éƒ½è¦åŠ å…¥åˆ° containerView&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;UIView&lt;/span&gt; *)containerView;	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// é€šè¿‡ key æ¥è¿”å›è½¬åœºå‰ï¼Œè½¬åœºåçš„ view controller&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// UITransitionContextFromViewControllerKey&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// UITransitionContextToViewControllerKey&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)viewControllerForKey:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)key;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// å¯ä»¥å¾—åˆ°å‚ä¸è½¬åœºçš„ view controller èµ·å§‹å’Œç»“æŸæ—¶çš„ frameï¼Œä¸€èˆ¬æ¥è¯´é€šè¿‡ fromVC çš„åˆ°èµ·å§‹çš„ï¼Œé€šè¿‡ toVC çš„åˆ°ç»“æŸæ—¶çš„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;CGRect&lt;/span&gt;)initialFrameForViewController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)vc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;CGRect&lt;/span&gt;)finalFrameForViewController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)vc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// åœ¨è½¬åœºåŠ¨ç”»ç»“æŸï¼Œæˆ–è€…å–æ¶ˆæ—¶è¦é€šçŸ¥ç³»ç»Ÿæ˜¯å¦å®Œæˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)completeTransition:(&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt;)didComplete;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç¬¬äºŒä¸ªåè®®&lt;code&gt;UIViewControllerAnimatedTransitioning&lt;/code&gt; è´Ÿè´£çš„æ˜¯è½¬åœºåŠ¨ç”»çš„å†…å®¹ï¼Œæˆ‘æŠŠå®ç°äº†è¿™ä¸ªåè®®çš„å¯¹è±¡ç§°ä½œ&lt;code&gt;åŠ¨ç”»æ§åˆ¶å™¨&lt;/code&gt;ã€‚å®ƒæœ‰ä¸¤ä¸ªå¿…é¡»å®ç°çš„æ–¹æ³•ï¼š&lt;code&gt;- (NSTimeInterval)transitionDuration:&lt;/code&gt;å’Œ&lt;code&gt;- (void)animateTransition:&lt;/code&gt;ã€‚ç¬¬ä¸€ä¸ªæ–¹æ³•ç”¨æ¥è¿”å›åŠ¨ç”»çš„æ—¶é•¿ï¼Œè€Œç¬¬äºŒä¸ªæ–¹æ³•å°±æ˜¯å®ç°åŠ¨ç”»çš„è¿‡ç¨‹ï¼Œå®ƒæœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯ä¸€ä¸ª&lt;code&gt;è½¬åœºä¸Šä¸‹æ–‡&lt;/code&gt;ï¼Œé€šè¿‡è¿™ä¸ªå‚æ•°æˆ‘ä»¬å¯ä»¥å–åˆ°å¾ˆå¤šè½¬åœºçš„ä¿¡æ¯ï¼Œç„¶åè¿›è¡ŒåŠ¨ç”»ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰ä¸ªåè®®&lt;code&gt;UIViewControllerTransitioningDelegate&lt;/code&gt; æˆ‘ä»¬éœ€è®¾ç½®&lt;code&gt;presentedVC&lt;/code&gt;çš„&lt;code&gt;transitioningDelegate&lt;/code&gt;å±æ€§ä¸ºä¸€ä¸ªå®ç°äº†è¿™ä¸ªåè®®çš„å¯¹è±¡ã€‚æˆ‘ä»¬ç°åœ¨åªè¦å…ˆå…³æ³¨è¿™ä¸ªåè®®çš„ä¸¤ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// è¿”å› present åŠ¨ç”»æ§åˆ¶å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &amp;lt;&lt;span class=&quot;built_in&quot;&gt;UIViewControllerAnimatedTransitioning&lt;/span&gt;&amp;gt;)animationControllerForPresentedController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)presented presentingController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)presenting sourceController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)source;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// è¿”å› dismiss åŠ¨ç”»æ§åˆ¶å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &amp;lt;&lt;span class=&quot;built_in&quot;&gt;UIViewControllerAnimatedTransitioning&lt;/span&gt;&amp;gt;)animationControllerForDismissedController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)dismissed;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥æŠŠ present å’Œ dismiss åŠ¨ç”»æ§åˆ¶å™¨å†™æˆä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨å†…éƒ¨é€šè¿‡ä¸€äº›é€»è¾‘åˆ¤æ–­æ¥æ‰§è¡Œå¯¹åº”çš„åŠ¨ç”»ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åˆ†æˆä¸¤ä¸ªå¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨çŸ¥é“äº†ä¸Šé¢è¿™äº›å†…å®¹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸€èµ·æ¥å†™ä¸€ä¸ª demo æ¥å­¦ä¹ è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»äº†ã€‚&lt;/p&gt;
&lt;h3 id=&quot;Demo&quot;&gt;&lt;a href=&quot;#Demo&quot; class=&quot;headerlink&quot; title=&quot;Demo&quot;&gt;&lt;/a&gt;Demo&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;å…ˆå†™ä¸¤ä¸ª view controllerï¼Œåˆ†åˆ«æ˜¯ presentingVC å’Œ presentedVCï¼Œå†…å®¹åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘å°±ä¸è´´ä¸¤ä»½äº†ã€‚åªæœ‰&lt;code&gt;buttonClicked&lt;/code&gt;æ–¹æ³•ä¸ä¸€æ ·ï¼Œä¸€ä¸ªæ˜¯ presentï¼Œ ä¸€ä¸ªæ˜¯ dismissã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;PresentingViewController&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewDidLoad &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewDidLoad];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;UIButton&lt;/span&gt; *button = [&lt;span class=&quot;built_in&quot;&gt;UIButton&lt;/span&gt; buttonWithType:&lt;span class=&quot;built_in&quot;&gt;UIButtonTypeSystem&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    button.bounds = &lt;span class=&quot;built_in&quot;&gt;CGRectMake&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    button.center = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.view.center;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [button setTitle:&lt;span class=&quot;string&quot;&gt;@&quot;present view controller&quot;&lt;/span&gt; forState:&lt;span class=&quot;built_in&quot;&gt;UIControlStateNormal&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [button addTarget:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; action:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(buttonClicked) forControlEvents:&lt;span class=&quot;built_in&quot;&gt;UIControlEventTouchUpInside&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.view addSubview:button];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)buttonClicked &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    PresentedViewController *presentedVC = [PresentedViewController new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; presentViewController:presentedVC animated:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt; completion:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ----- in PresentedViewController.m -----&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)buttonClicked &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; dismissViewControllerAnimated:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt; completion:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å®Œæˆè¿™äº›åæˆ‘ä»¬çš„ç¨‹åºå°±èƒ½å®ç°è½¬åœºäº†ï¼Œåªä¸è¿‡æ˜¯ç³»ç»Ÿé»˜è®¤çš„è½¬åœºæ–¹å¼ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å†™ä¸€ä¸ªè‡ªå·±çš„åŠ¨ç”»æ§åˆ¶å™¨ï¼Œä¸ºäº†åŒºåˆ†å’Œç³»ç»Ÿçš„åŠ¨ç”»ï¼Œæˆ‘ä»¬çš„åŠ¨ç”»é€‰æ‹©&lt;code&gt;ä»ä¸Šå¾€ä¸‹&lt;/code&gt;åˆ’å‡ºçš„è½¬åœºæ–¹å¼ã€‚æˆ‘ä»¬æ–°å»ºä¸€ä¸ªç±»ï¼Œè®©å®ƒéµå¾ª&lt;code&gt;UIViewControllerAnimatedTransitioning&lt;/code&gt;åè®®ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// AnimationController.h&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AnimationController&lt;/span&gt; : &lt;span class=&quot;title&quot;&gt;NSObject&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;UIViewControllerAnimatedTransitioning&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// AnimationController.m&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AnimationController&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// è½¬åœºçš„æ—¶é—´&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;NSTimeInterval&lt;/span&gt;)transitionDuration:(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&amp;lt;&lt;span class=&quot;built_in&quot;&gt;UIViewControllerContextTransitioning&lt;/span&gt;&amp;gt;)transitionContext &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0.8&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// è½¬åœºåŠ¨ç”»å®ç°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)animateTransition:(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&amp;lt;&lt;span class=&quot;built_in&quot;&gt;UIViewControllerContextTransitioning&lt;/span&gt;&amp;gt;)transitionContext &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// é€šè¿‡ key å–åˆ° fromVC å’Œ toVC&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *fromVC = [transitionContext viewControllerForKey:&lt;span class=&quot;built_in&quot;&gt;UITransitionContextFromViewControllerKey&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *toVC = [transitionContext viewControllerForKey:&lt;span class=&quot;built_in&quot;&gt;UITransitionContextToViewControllerKey&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// æŠŠ toVC åŠ å…¥åˆ° containerView&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;UIView&lt;/span&gt; *containerView = [transitionContext containerView];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [containerView addSubview:toVC.view];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// ä¸€äº›åŠ¨ç”»è¦ç”¨çš„çš„æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGRect&lt;/span&gt; finalFrame = [transitionContext finalFrameForViewController:toVC];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSTimeInterval&lt;/span&gt; duration = [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; transitionDuration:transitionContext];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// åŠ¨ç”»è¿‡ç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (toVC.isBeingPresented) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        toVC.view.frame = &lt;span class=&quot;built_in&quot;&gt;CGRectOffset&lt;/span&gt;(finalFrame, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -finalFrame.size.height);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;built_in&quot;&gt;UIView&lt;/span&gt; animateWithDuration:duration&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                         animations:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             toVC.view.frame = finalFrame;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                         &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                         completion:^(&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt; finished) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             &lt;span class=&quot;comment&quot;&gt;// ç»“æŸåè¦é€šçŸ¥ç³»ç»Ÿ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             [transitionContext completeTransition:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                         &amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (fromVC.isBeingDismissed) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [containerView sendSubviewToBack:toVC.view];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;built_in&quot;&gt;UIView&lt;/span&gt; animateWithDuration:duration&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                         animations:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             fromVC.view.frame = &lt;span class=&quot;built_in&quot;&gt;CGRectOffset&lt;/span&gt;(finalFrame, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -finalFrame.size.height);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                         &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                         completion:^(&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt; finished) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             &lt;span class=&quot;comment&quot;&gt;// dismiss åŠ¨ç”»æ·»åŠ äº†æ‰‹åŠ¿åå¯èƒ½å‡ºç°è½¬åœºå–æ¶ˆçš„çŠ¶æ€ï¼Œæ‰€ä»¥è¦æ ¹æ®çŠ¶æ€æ¥åˆ¤å®šæ˜¯å¦å®Œæˆè½¬åœº&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             &lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt; isComplete = ![transitionContext transitionWasCancelled];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             [transitionContext completeTransition:isComplete];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                         &amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬è¿”å›äº†åŠ¨ç”»çš„æ—¶é—´ 0.8 ç§’&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒä¸ªæ–¹æ³•&lt;ul&gt;
&lt;li&gt;å…ˆé€šè¿‡ key å–åˆ° fromVC å’Œ toVCã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åæŠŠ toVC çš„ view åŠ å…¥åˆ° containerView ä¸­ ï¼ŒfromVC çš„ view æ˜¯æœ¬æ¥å°±åœ¨ containerView ä¸­çš„&lt;/li&gt;
&lt;li&gt;åŠ¨ç”»çš„è¿‡ç¨‹åˆ†ä¸ºä¸¤å—ï¼Œåˆ†åˆ«æ˜¯ present åŠ¨ç”» å’Œ dismiss åŠ¨ç”»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ UIViewController è‡ªå¸¦çš„ &lt;code&gt;isBeingPresented&lt;/code&gt; å’Œ  &lt;code&gt;isBeingDismissed&lt;/code&gt; å±æ€§æ¥åˆ¤æ–­å½“å‰æ˜¯é‚£ç§ç±»å‹çš„è½¬åœºã€‚åŠ¨ç”»çš„è¿‡ç¨‹å°±å¯ä»¥è‡ªå·±å‘æŒ¥æƒ³è±¡åŠ›äº†ã€‚åœ¨åŠ¨ç”»ç»“æŸåè¦é€šçŸ¥ç³»ç»Ÿå®Œæˆè½¬åœºï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºç¨åæˆ‘ä»¬è¦ç»™ dismiss æ·»åŠ æ‰‹åŠ¿é©±åŠ¨ï¼Œæ‰€ä»¥è½¬åœºå­˜åœ¨å–æ¶ˆçš„å¯èƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡&lt;code&gt;[transitionContext transitionWasCancelled]&lt;/code&gt;æ¥å¾—åˆ°è½¬åœºçš„çŠ¶æ€ï¼Œå†åˆ¤æ–­æ˜¯å¦é€šçŸ¥ç³»ç»Ÿè½¬åœºå®Œæˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬è¦é€šè¿‡&lt;code&gt;UIViewControllerTransitioningDelegate&lt;/code&gt;æŠŠ&lt;code&gt;åŠ¨ç”»æ§åˆ¶å™¨&lt;/code&gt;å’Œ&lt;code&gt;è§†å›¾æ§åˆ¶å™¨&lt;/code&gt;è”ç³»èµ·æ¥ã€‚æˆ‘ä»¬è¦ç»™&lt;code&gt;PresentingViewController&lt;/code&gt;æ·»åŠ ä¸€äº›å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆè®© &lt;code&gt;presentingVC&lt;/code&gt; éµå¾ª &lt;code&gt;UIViewControllerTransitioningDelegate&lt;/code&gt; åè®®ï¼Œå¹¶ä¸”æ·»åŠ ä¸€ä¸ªå±æ€§ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;PresentingViewController&lt;/span&gt; ()&amp;lt;&lt;span class=&quot;title&quot;&gt;UIViewControllerTransitioningDelegate&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// åŠ¨ç”»æ§åˆ¶å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;strong&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&amp;lt;&lt;span class=&quot;built_in&quot;&gt;UIViewControllerAnimatedTransitioning&lt;/span&gt;&amp;gt; animationController;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶ååœ¨&lt;code&gt;- (void)viewDidLoad&lt;/code&gt;ä¸­åˆå§‹åŒ–åŠ¨ç”»æ§åˆ¶å™¨ &lt;code&gt;_animationController = [AnimationController new];&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewDidLoad &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewDidLoad];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// åˆå§‹åŒ–åŠ¨ç”»æ§åˆ¶å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    _animationController = [AnimationController new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ¥ç€åœ¨ &lt;code&gt;- (void)buttonClicked&lt;/code&gt;æ–¹æ³•ä¸­è®¾ç½®&lt;code&gt;presentedVC&lt;/code&gt;çš„ä»£ç†&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)buttonClicked &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    PresentedViewController *presentedVC = [PresentedViewController new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// è®¾ç½® presented view controller çš„è½¬åœºä»£ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    presentedVC.transitioningDelegate = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; presentViewController:presentedVC animated:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt; completion:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æœ€åæ·»åŠ ä¸¤ä¸ªä»£ç†æ–¹æ³•&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// è¿”å› present åŠ¨ç”»æ§åˆ¶å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&amp;lt;&lt;span class=&quot;built_in&quot;&gt;UIViewControllerAnimatedTransitioning&lt;/span&gt;&amp;gt;)animationControllerForPresentedController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)presented presentingController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)presenting sourceController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)source &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; _animationController;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// è¿”å› dismiss åŠ¨ç”»æ§åˆ¶å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&amp;lt;&lt;span class=&quot;built_in&quot;&gt;UIViewControllerAnimatedTransitioning&lt;/span&gt;&amp;gt;)animationControllerForDismissedController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)dismissed &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; _animationController;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„è½¬åœºåŠ¨ç”»äº†ğŸ˜€&lt;/p&gt;
&lt;h3 id=&quot;æ³¨æ„ç‚¹&quot;&gt;&lt;a href=&quot;#æ³¨æ„ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;æ³¨æ„ç‚¹&quot;&gt;&lt;/a&gt;æ³¨æ„ç‚¹&lt;/h3&gt;&lt;p&gt;presentedVC çš„ modalPresentationStyle é»˜è®¤ä¸º&lt;code&gt;UIModalPresentationFullScreen&lt;/code&gt;,è¿™ç§æƒ…å†µä¸‹åœ¨è½¬åœºå®Œæˆåç³»ç»Ÿä¼šè‡ªåŠ¨éšè— presentingVC çš„ view ã€‚å¦‚æœæˆ‘ä»¬è®¾ç½®äº† &lt;code&gt;UIModalPresentationCustom&lt;/code&gt;é‚£ä¹ˆè½¬åœºå®Œæˆåï¼ŒpresentingVC çš„ view ä¸ä¼šéšè—ã€‚ä¸€èˆ¬æ¥è¯´åœ¨åŠ¨ç”»çš„æ—¶å€™æˆ‘ä»¬éƒ½ä¼šæŠŠ toVC çš„ view åŠ å…¥åˆ° containerView ä¸­ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹æ‰§è¡Œ dismiss çš„æ—¶å€™æˆ‘ä»¬ä¸èƒ½æŠŠ toVC.viewï¼ˆpresentingVC.viewï¼‰ åŠ å…¥åˆ° containerView ä¸­ï¼Œå› ä¸ºè¿™ä¸ª view å¹¶ç”±ç³»ç»Ÿé¢å¤–ç®¡ç†ï¼Œå¦‚æœæˆ‘ä»¬æ”¹å˜äº†å®ƒï¼Œé‚£å°±æœ‰å¯èƒ½æŠŠä»åŸæ¥çš„è§†å›¾å±‚æ¬¡ä¸­ç§»é™¤è€Œå¯¼è‡´å®ƒæ¶ˆå¤±ä¸è§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;äº¤äº’å¼è½¬åœº&quot;&gt;&lt;a href=&quot;#äº¤äº’å¼è½¬åœº&quot; class=&quot;headerlink&quot; title=&quot;äº¤äº’å¼è½¬åœº&quot;&gt;&lt;/a&gt;äº¤äº’å¼è½¬åœº&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;å®ç°äº¤äº’å¼çš„è½¬åœºéœ€è¦åœ¨&lt;code&gt;UIViewControllerTransitioningDelegate&lt;/code&gt;çš„åè®®æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªå®ç°äº†&lt;code&gt;UIViewControllerInteractiveTransitioning&lt;/code&gt;çš„å¯¹è±¡ã€‚å®˜æ–¹å·²ç»ç»™æˆ‘ä»¬å°è£…å¥½äº†ä¸€ä¸ª&lt;code&gt;UIPercentDrivenInteractiveTransition&lt;/code&gt;ç±»ï¼Œæˆ‘ä»¬åªè¦ç»§æ‰¿è¿™ä¸ªç±»åœ¨åŠ å…¥æˆ‘ä»¬è‡ªå·±çš„ä¸€äº›å†…å®¹å°±å¯ä»¥å®ç°äº¤äº’å¼è½¬åœºã€‚æœ‰å‡ ä¸ªæ–¹æ³•æˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// æ›´æ–°è½¬åœºçŠ¶æ€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)updateInteractiveTransition:(&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)percentComplete;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// å–æ¶ˆè½¬åœº&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)cancelInteractiveTransition;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// å®Œæˆè½¬åœº&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)finishInteractiveTransition;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è½¬åœºå‘ç”Ÿæ—¶ï¼Œå¦‚æœè¿”å›äº†&lt;code&gt;äº¤äº’æ§åˆ¶å™¨&lt;/code&gt;ï¼Œä½†æ˜¯å´æ²¡æœ‰é€šè¿‡äº¤äº’çš„æ–¹å¼æ¥æ‰§è¡Œè½¬åœºï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹å°±å¡ä½ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™äº¤äº’æ§åˆ¶å™¨æ·»åŠ ä¸€ä¸ªå±æ€§ï¼Œç”¨æ¥ç›‘å¬å½“å‰æ˜¯å¦æ˜¯é€šè¿‡æ‰‹åŠ¿é©±åŠ¨ï¼Œå¦‚æœä¸æ˜¯æˆ‘ä»¬å°±è¿”å›ä¸€ä¸ª nilï¼Œè¿™æ ·å°±ä¸ä¼šæ‰§è¡Œäº¤äº’å¼è½¬åœºï¼Œè€Œåªä¼šæ‰§è¡Œæ™®é€šçš„åŠ¨ç”»è½¬åœºã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// InteractionController.h&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;InteractionController&lt;/span&gt; : &lt;span class=&quot;title&quot;&gt;UIPercentDrivenInteractiveTransition&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// æ ‡è®°æ˜¯å¦æ˜¯äº¤äº’è½¬åœº&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;readonly&lt;/span&gt;, getter=isInteracting)&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt; interacting;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ä¸€äº›åˆå§‹åŒ–å·¥ä½œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)prepareForViewController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)viewController;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// InteractionController.m&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;InteractionController&lt;/span&gt; ()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;weak&lt;/span&gt;)&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *presentedVC;	&lt;span class=&quot;comment&quot;&gt;// æ³¨æ„æ˜¯å¼±å¼•ç”¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;assign&lt;/span&gt;)&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt; shouldComplete;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;InteractionController&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ç»™ viewController çš„ view æ·»åŠ æ‰‹åŠ¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)prepareForViewController:(&lt;span class=&quot;built_in&quot;&gt;UIViewController&lt;/span&gt; *)viewController &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    _presentedVC = viewController;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;UIPanGestureRecognizer&lt;/span&gt; *panGesture = [[&lt;span class=&quot;built_in&quot;&gt;UIPanGestureRecognizer&lt;/span&gt; alloc] initWithTarget:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; action:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(panGestureAction:)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [viewController.view addGestureRecognizer:panGesture];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)panGestureAction:(&lt;span class=&quot;built_in&quot;&gt;UIPanGestureRecognizer&lt;/span&gt; *)gestureRecognizer &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGPoint&lt;/span&gt; translation = [gestureRecognizer translationInView:gestureRecognizer.view.superview];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// åŠ¨ç”»çš„ç™¾åˆ†æ¯”&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; percent = &lt;span class=&quot;number&quot;&gt;0.0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;switch&lt;/span&gt; (gestureRecognizer.state) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;UIGestureRecognizerStateBegan&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// è®¾ç½®äº¤äº’çŠ¶æ€ä¸º YES&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            _interacting = &lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// æ‰‹åŠ¿å¼€å§‹æ—¶è¦è°ƒç”¨ dismiss&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            [_presentedVC dismissViewControllerAnimated:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt; completion:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;UIGestureRecognizerStateChanged&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// è®¡ç®—ç™¾åˆ†æ¯”&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            percent = -translation.y/_presentedVC.view.bounds.size.height;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// æ›´æ–°è½¬åœºçš„è¿›åº¦ ä¼ å…¥çš„å‚æ•°å€¼è¦åœ¨ 0.0~1.0 ä¹‹é—´&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; updateInteractiveTransition:percent];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// å¦‚æœæ»‘åŠ¨è¶…è¿‡ 30% å°±è§†ä¸ºè½¬åœºå®Œæˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            _shouldComplete = (percent &amp;gt; &lt;span class=&quot;number&quot;&gt;0.3&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;UIGestureRecognizerStateCancelled&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            _interacting = &lt;span class=&quot;literal&quot;&gt;NO&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; cancelInteractiveTransition];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;UIGestureRecognizerStateEnded&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            _interacting = &lt;span class=&quot;literal&quot;&gt;NO&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (_shouldComplete) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; finishInteractiveTransition];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; cancelInteractiveTransition];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ³¨é‡Šå·²ç»å†™å¾—å¾ˆè¯¦ç»†äº†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨å®Œæˆæˆ–è€…å–æ¶ˆçš„æ—¶å€™ä¸€å®šè¦è°ƒç”¨å¯¹åº”çš„æ–¹æ³•æ¥é€šçŸ¥ç³»ç»Ÿã€‚å®Œæˆäº†è¿™ä¸ªç±»åæˆ‘ä»¬éœ€è¦å†æ¬¡ä¿®æ”¹ &lt;code&gt;PresentingViewController&lt;/code&gt;çš„å†…å®¹ã€‚    &lt;/p&gt;
&lt;p&gt;å†æ·»åŠ ä¸€ä¸ªå±æ€§&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;strong&lt;/span&gt;)InteractionController *interactiveTransition;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¹¶ä¸”åœ¨&lt;code&gt;- (void)viewDidLoad&lt;/code&gt;ä¸­åˆå§‹åŒ–å®ƒ&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewDidLoad &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewDidLoad];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// åˆå§‹åŒ–äº¤äº’æ§åˆ¶å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    _interactiveTransition = [InteractionController new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨&lt;code&gt;- (void)buttonClicked&lt;/code&gt;ä¸­æ‰§è¡Œ&lt;code&gt;- (void)prepareForViewController:(UIViewController *)viewController&lt;/code&gt;æ–¹æ³•&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)buttonClicked &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// æ·»åŠ äº¤äº’&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [_interactiveTransition prepareForViewController:presentedVC];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; presentViewController:presentedVC animated:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt; completion:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨æœ€åæ·»åŠ åè®®æ–¹æ³•,åœ¨æ–¹æ³•ä¸­è¦é€šè¿‡ &lt;code&gt;isInteracting&lt;/code&gt; å±æ€§æ¥åˆ¤æ–­æ˜¯å¦æ˜¯æ‰§è¡Œäº¤äº’å¼è½¬åœºï¼Œå¦‚æœä¸æ˜¯åˆ™è¿”å› &lt;code&gt;nil&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// è¿”å› dismiss çš„äº¤äº’æ§åˆ¶å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&amp;lt;&lt;span class=&quot;built_in&quot;&gt;UIViewControllerInteractiveTransitioning&lt;/span&gt;&amp;gt;)interactionControllerForDismissal:(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&amp;lt;&lt;span class=&quot;built_in&quot;&gt;UIViewControllerAnimatedTransitioning&lt;/span&gt;&amp;gt;)animator &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; _interactiveTransition.isInteracting ? _interactiveTransition : &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å…³äºæ™®é€šçš„ view controller çš„è‡ªå®šä¹‰è½¬åœºå°±åˆ°æ­¤ç»“æŸäº†ã€‚å¦‚æœä½ æŒ‰ç…§æ–‡ç« çš„æ­¥éª¤ä¸€æ­¥ä¸€æ­¥å†™ä¸‹æ¥ï¼Œç›¸ä¿¡ä½ å·²ç»å®Œæˆäº†ä¸€ä¸ªæœ€ç®€å•çš„è‡ªå®šä¹‰è½¬åœºã€‚&lt;/p&gt;
&lt;h2 id=&quot;å®¹å™¨-view-controller-çš„è‡ªå®šä¹‰è½¬åœº&quot;&gt;&lt;a href=&quot;#å®¹å™¨-view-controller-çš„è‡ªå®šä¹‰è½¬åœº&quot; class=&quot;headerlink&quot; title=&quot;å®¹å™¨ view controller çš„è‡ªå®šä¹‰è½¬åœº&quot;&gt;&lt;/a&gt;å®¹å™¨ view controller çš„è‡ªå®šä¹‰è½¬åœº&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;&lt;code&gt;UINavigationController&lt;/code&gt;ï¼Œ&lt;code&gt;UITabBarController&lt;/code&gt; éƒ½å±äº å®¹å™¨VCã€‚ä¸æ™®é€šçš„ VC ä¸åŒçš„æ˜¯ï¼Œå®ƒä»¬é€šè¿‡ &lt;code&gt;UINavigationControllerDelegate&lt;/code&gt;æˆ–è€…&lt;code&gt;UITabBarControllerDelegate&lt;/code&gt;çš„ä»£ç†æ–¹æ³•æ¥è¿”å›&lt;code&gt;åŠ¨ç”»æ§åˆ¶å™¨&lt;/code&gt;ï¼Œè€ŒåŠ¨ç”»æ§åˆ¶å™¨çš„å…·ä½“å®ç°ï¼Œå‡ ä¹æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚æˆ‘æ”¾åœ¨ &lt;a href=&quot;https://github.com/Hcy91425/Demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;github ä¸Šçš„ Demo&lt;/a&gt; ä¸­ï¼Œæœ‰è¿™ä¸‰ç§è‡ªå®šè½¬åœºçš„ä»£ç ï¼Œç”¨çš„åŸºæœ¬ä¸Šæ˜¯åŒä¸€ä¸ª animationController ï¼Œå¦‚æœä½ æŒæ¡äº†å‰é¢çš„å†…å®¹ï¼Œé‚£ä¹ˆè¿™é‡Œä¹Ÿå°±ä¸æ˜¯é—®é¢˜äº†ã€‚å…·ä½“çš„ä»£ç æˆ‘å°±ä¸å±•å¼€äº†ã€‚&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/heading-customTransition.png&quot;&gt;&lt;/div&gt;

&lt;p&gt;è¿™ä¸¤å¤©å­¦ä¹ äº†ä¸€ä¸‹è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»çš„å†…å®¹ï¼Œåˆšå¼€å§‹çœ‹çš„æ—¶å€™è¢«è¿™å‡ ä¸ªåˆé•¿åˆå¾ˆç›¸ä¼¼çš„åè®®å¼„çš„æ™•å¤´è½¬å‘ï¼Œæ‰€ä»¥å¸Œæœ›èƒ½å†™ä¸€ç¯‡æµ…æ˜¾æ˜“æ‡‚çš„å…¥é—¨æ–‡ç« ã€‚æœ¬æ–‡çš„å†…å®¹ä¼šæ¯”è¾ƒåŸºç¡€ï¼Œä¸ä¼šæ¶‰åŠçš„å¾ˆæ·±çš„ï¼Œå°±åƒé¢˜ç›®è¯´çš„&lt;code&gt;åˆçª¥&lt;/code&gt;ã€‚é€šè¿‡æœ¬æ–‡å¯ä»¥ç”¨æœ€ç®€å•çš„æ–¹å¼å®ç°æœ€ç®€å•çš„è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ã€‚å¦‚æœä½ éœ€è¦æ›´åŠ æ·±å…¥çš„çŸ¥è¯†ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="UIKit å­¦ä¹ " scheme="http://yoursite.com/categories/UIKit-%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="è‡ªå®šä¹‰è½¬åœº" scheme="http://yoursite.com/tags/%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E5%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>Objective-C å—ï¼ˆBlockï¼‰çš„ä½¿ç”¨ä¸ç†è§£</title>
    <link href="http://yoursite.com/2016/03/13/Objective-C-%E5%9D%97%EF%BC%88Block%EF%BC%89%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%8E%E7%90%86%E8%A7%A3/"/>
    <id>http://yoursite.com/2016/03/13/Objective-C-å—ï¼ˆBlockï¼‰çš„ä½¿ç”¨ä¸ç†è§£/</id>
    <published>2016-03-13T08:33:30.000Z</published>
    <updated>2016-03-30T02:24:43.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrad5.com1.z0.glb.clouddn.com/heading_block.png&quot;&gt;&lt;/div&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å—ï¼ˆBlockï¼‰æ˜¯åœ¨ iOS å¼€å‘ä¸­å¾ˆå¸¸ç”¨çš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒå¯ä»¥ä½¿æˆ‘ä»¬ä»£ç çš„ä¸šåŠ¡é€»è¾‘æ›´åŠ çš„ç´§å‡‘ã€‚æœ¬æ–‡ä¼šåˆ†ä¸¤éƒ¨åˆ†æ¥è®²å—ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯å—çš„åŸºç¡€çŸ¥è¯†ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯å¯¹å—çš„æœ¬è´¨çš„ä¸€äº›ç†è§£ã€‚&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;å—çš„åŸºç¡€çŸ¥è¯†&quot;&gt;&lt;a href=&quot;#å—çš„åŸºç¡€çŸ¥è¯†&quot; class=&quot;headerlink&quot; title=&quot;å—çš„åŸºç¡€çŸ¥è¯†&quot;&gt;&lt;/a&gt;å—çš„åŸºç¡€çŸ¥è¯†&lt;/h2&gt;&lt;hr&gt;
&lt;h3 id=&quot;å—çš„å£°æ˜&quot;&gt;&lt;a href=&quot;#å—çš„å£°æ˜&quot; class=&quot;headerlink&quot; title=&quot;å—çš„å£°æ˜&quot;&gt;&lt;/a&gt;å—çš„å£°æ˜&lt;/h3&gt;&lt;p&gt;å—çš„å£°æ˜ç±»ä¼¼äºå‡½æ•°æŒ‡é’ˆï¼Œåªä¸è¿‡æŠŠ * æ¢æˆäº† ^ ã€‚å£°æ˜æ—¶æœ€å‰é¢æ˜¯è¿”å›ç±»å‹ï¼Œä¸­é—´æ˜¯å—åï¼Œæœ€åæ˜¯å‚æ•°ç±»å‹ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// returnType (^blockName) (parameters)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; (^someBlock) (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;å—çš„å®ç°&quot;&gt;&lt;a href=&quot;#å—çš„å®ç°&quot; class=&quot;headerlink&quot; title=&quot;å—çš„å®ç°&quot;&gt;&lt;/a&gt;å—çš„å®ç°&lt;/h3&gt;&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ^returnType(parameters)&amp;#123;/*code*/&amp;#125;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;^&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a+b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å…¶ä¸­è¿”å›å€¼æ˜¯å¯ä»¥çœç•¥çš„,å®ƒå¯ä»¥è‡ªåŠ¨åˆ¤æ–­ï¼Œå¦‚æœå‚æ•°ä¹Ÿæ˜¯ç©ºçš„è¯æˆ‘ä»¬å¯ä»¥ç®€åŒ–æˆè¿™æ ·ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;å—çš„ä½¿ç”¨&quot;&gt;&lt;a href=&quot;#å—çš„ä½¿ç”¨&quot; class=&quot;headerlink&quot; title=&quot;å—çš„ä½¿ç”¨&quot;&gt;&lt;/a&gt;å—çš„ä½¿ç”¨&lt;/h3&gt;&lt;p&gt;å—çš„ä½¿ç”¨å°±åƒä½¿ç”¨ C å‡½æ•°ä¸€æ ·&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;someBlockï¼ˆ&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;ï¼Œ&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;ï¼‰;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;ç”¨-typedef-æ¥ç®€åŒ–å—çš„å£°æ˜&quot;&gt;&lt;a href=&quot;#ç”¨-typedef-æ¥ç®€åŒ–å—çš„å£°æ˜&quot; class=&quot;headerlink&quot; title=&quot;ç”¨ typedef æ¥ç®€åŒ–å—çš„å£°æ˜&quot;&gt;&lt;/a&gt;ç”¨ typedef æ¥ç®€åŒ–å—çš„å£°æ˜&lt;/h3&gt;&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; (^CYAddBlock) (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CYAddBlock addBlock = ^(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; b) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a+b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;addBlock(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;å—èƒ½æ•è·åœ¨å®ƒå£°æ˜èŒƒå›´é‡Œçš„æ‰€æœ‰å˜é‡&quot;&gt;&lt;a href=&quot;#å—èƒ½æ•è·åœ¨å®ƒå£°æ˜èŒƒå›´é‡Œçš„æ‰€æœ‰å˜é‡&quot; class=&quot;headerlink&quot; title=&quot;å—èƒ½æ•è·åœ¨å®ƒå£°æ˜èŒƒå›´é‡Œçš„æ‰€æœ‰å˜é‡&quot;&gt;&lt;/a&gt;å—èƒ½æ•è·åœ¨å®ƒå£°æ˜èŒƒå›´é‡Œçš„æ‰€æœ‰å˜é‡&lt;/h3&gt;&lt;p&gt;ä½†æ˜¯ä¸èƒ½å†å—ä¸­ä¿®æ”¹æ•è·åˆ°çš„å˜é‡ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•ä¿®æ”¹ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œæ— æ³•é€šè¿‡ç¼–è¯‘ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; (^someBlock) () = ^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; result = someBlock();	&lt;span class=&quot;comment&quot;&gt;// result = 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;ç”¨-block-ä¿®é¥°å˜é‡ï¼Œå¯ä»¥åœ¨å—ä¸­ä¿®æ”¹å˜é‡çš„å€¼&quot;&gt;&lt;a href=&quot;#ç”¨-block-ä¿®é¥°å˜é‡ï¼Œå¯ä»¥åœ¨å—ä¸­ä¿®æ”¹å˜é‡çš„å€¼&quot; class=&quot;headerlink&quot; title=&quot;ç”¨ __block ä¿®é¥°å˜é‡ï¼Œå¯ä»¥åœ¨å—ä¸­ä¿®æ”¹å˜é‡çš„å€¼&quot;&gt;&lt;/a&gt;ç”¨ __block ä¿®é¥°å˜é‡ï¼Œå¯ä»¥åœ¨å—ä¸­ä¿®æ”¹å˜é‡çš„å€¼&lt;/h3&gt;&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;__block &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; (^someBlock) () = ^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ++count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; result = someBlock();	&lt;span class=&quot;comment&quot;&gt;// result = 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å…¶å®å—åœ¨æ•è·å˜é‡æ—¶åªæ˜¯æ‹·è´äº†ä¸€ä»½å˜é‡çš„å€¼ï¼Œè€Œç”¨ __block ä¿®é¥°åï¼Œæ‹·è´çš„æ˜¯å˜é‡çš„åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥åœ¨å—ä¸­ä¿®æ”¹å˜é‡äº†ã€‚è¿™å°±å’Œ C è¯­è¨€ä¸­å‡½æ•°çš„å‚æ•°æ˜¯ç±»ä¼¼çš„é“ç†ã€‚&lt;/p&gt;
&lt;h3 id=&quot;å°å¿ƒäº§ç”Ÿå¾ªç¯å¼•ç”¨&quot;&gt;&lt;a href=&quot;#å°å¿ƒäº§ç”Ÿå¾ªç¯å¼•ç”¨&quot; class=&quot;headerlink&quot; title=&quot;å°å¿ƒäº§ç”Ÿå¾ªç¯å¼•ç”¨&quot;&gt;&lt;/a&gt;å°å¿ƒäº§ç”Ÿå¾ªç¯å¼•ç”¨&lt;/h3&gt;&lt;p&gt;åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œå—èƒ½ç›´æ¥è®¿é—®å¹¶ä¿®æ”¹å®ä¾‹å˜é‡çš„å€¼ï¼Œä½†æ˜¯ä¸€å®šè¦æ³¨æ„ä¸ç®¡æ˜¯é€šè¿‡ self æ¥è®¿é—®å±æ€§è¿˜æ˜¯ç›´æ¥é€šè¿‡ _instanceVariable æ¥è®¿é—®&lt;strong&gt;éƒ½ä¼šæ•è· self&lt;/strong&gt;ã€‚å› ä¸ºåœ¨ç›´æ¥è®¿é—® _instanceVariable ç­‰æ•ˆäºè¿™æ ·ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;-&amp;gt;_instanceVariable;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è€Œä¸€æ—¦æ•è·äº†selfï¼Œ æˆ‘ä»¬å°±ä¸€å®šè¦æ³¨æ„&lt;strong&gt;å¾ªç¯å¼•ç”¨&lt;/strong&gt;å¯¼è‡´çš„å†…å­˜æ³„éœ²äº†ã€‚æˆ‘ä»¬åœ¨ CYClass ä¸­å£°æ˜äº†ä¸€ä¸ªå—å’Œä¸€ä¸ªå±æ€§ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (^CYBlock) ();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CYClass&lt;/span&gt; : &lt;span class=&quot;title&quot;&gt;NSObject&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;copy&lt;/span&gt;)&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *aString;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;copy&lt;/span&gt;)CYBlock aBlock;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶åé‡å†™å®ƒçš„ init å’Œ dealloc æ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CYClass&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (instancetype)init&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; = [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; init]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _aString = &lt;span class=&quot;string&quot;&gt;@&quot;Hello Cyrus&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _aBlock = ^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, _aString);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)dealloc &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;CYClass deinit&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œç´§æ¥ç€å°±æŠŠå®ƒè®¾ä¸º nil ä¼šå‘ç° dealloc æ–¹æ³•å¹¶æ²¡æœ‰è¢«è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å‘ç”Ÿäº†å†…å­˜æ³„éœ²ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CYClass *c = [CYClass new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c = &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å°±åƒè¿™æ ·ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡ __weak æ¥æ‰“ç ´è¿™ä¸ªå¾ªç¯ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹åˆå§‹åŒ–æ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (instancetype)init&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; = [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; init]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _aString = &lt;span class=&quot;string&quot;&gt;@&quot;Hello Cyrus&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        __&lt;span class=&quot;keyword&quot;&gt;weak&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;) weakSelf = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _aBlock = ^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        	__&lt;span class=&quot;keyword&quot;&gt;strong&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;) strongSelf = weakSelf;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, strongSelf.aString);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨æ‰§è¡Œä¹‹å‰çš„ä»£ç å°±ä¼šå‘ç°è¿™ä¸ªå¯¹è±¡æˆåŠŸçš„é”€æ¯äº†ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-12&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;24.995&lt;/span&gt; BlockExample[&lt;span class=&quot;number&quot;&gt;4777&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;111670&lt;/span&gt;] CYClass deinit&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;å—çš„æœ¬è´¨&quot;&gt;&lt;a href=&quot;#å—çš„æœ¬è´¨&quot; class=&quot;headerlink&quot; title=&quot;å—çš„æœ¬è´¨&quot;&gt;&lt;/a&gt;å—çš„æœ¬è´¨&lt;/h2&gt;&lt;hr&gt;
&lt;h3 id=&quot;å—çš„ç»“æ„&quot;&gt;&lt;a href=&quot;#å—çš„ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;å—çš„ç»“æ„&quot;&gt;&lt;/a&gt;å—çš„ç»“æ„&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥åœ¨&lt;a href=&quot;https://llvm.org/svn/llvm-project/compiler-rt/tags/Apple/Libcompiler_rt-10/BlocksRuntime/Block_private.h&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;è¿™é‡Œ&lt;/a&gt;æ‰¾åˆ° Block çš„å®šä¹‰ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Block_descriptor &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; reserved;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (*&lt;span class=&quot;keyword&quot;&gt;copy&lt;/span&gt;)(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *dst, &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *src);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (*dispose)(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Block_layout &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *isa;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flags;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; reserved; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (*invoke)(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *, ...);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Block_descriptor *descriptor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/* Imported variables. */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;çœ‹åˆ° Block_layout ç»“æ„ä½“é‡Œçš„ç¬¬ä¸€ä¸ªå˜é‡æ˜¯ä¸€ä¸ª &lt;strong&gt;isa æŒ‡é’ˆ&lt;/strong&gt;ï¼Œ æˆ‘ä»¬åº”è¯¥å°±èƒ½çŒœåˆ° &lt;strong&gt;Block ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡&lt;/strong&gt;ã€‚ç„¶åå†çœ‹ç¬¬å››ä¸ªå˜é‡æ˜¯ä¸€ä¸ªå« &lt;strong&gt;invoke çš„å‡½æ•°æŒ‡é’ˆ&lt;/strong&gt;ï¼Œå®ƒæŒ‡å‘çš„å°±æ˜¯ &lt;strong&gt;Block å…·ä½“å®ç°çš„å‡½æ•°&lt;/strong&gt;äº†,è¿™ä¸ªå‡½æ•°è‡³å°‘è¦æ¥å—ä¸€ä¸ª void*  ç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯å—æœ¬èº«ã€‚å†ä¸‹é¢çš„ descriptor æŒ‡å‘çš„å°±æ˜¯ Block_descriptor ç»“æ„ä½“ï¼Œé‡Œé¢å°±æ˜¯ä¸€äº› Block çš„ä¿¡æ¯ã€‚è€Œåœ¨è¿™äº›å˜é‡ä¸‹é¢å­˜æ”¾çš„å°±æ˜¯ &lt;strong&gt;Block æ•è·çš„é‚£äº›å˜é‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&quot;å—çš„ç±»å‹&quot;&gt;&lt;a href=&quot;#å—çš„ç±»å‹&quot; class=&quot;headerlink&quot; title=&quot;å—çš„ç±»å‹&quot;&gt;&lt;/a&gt;å—çš„ç±»å‹&lt;/h3&gt;&lt;p&gt;åœ¨ OC ä¸­ä¸€å…±æœ‰3ç§å—ï¼Œåˆ†åˆ«æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…¨å±€å—ï¼Œä¸ä¼šè®¿é—®ä»»ä½•å¤–éƒ¨å˜é‡&lt;/li&gt;
&lt;li&gt;æ ˆå—ï¼Œä¿å­˜åœ¨æ ˆä¸­, å½“å‡½æ•°é€€å‡ºåå°±ä¼šè¢«é”€æ¯ï¼Œé€šè¿‡copyå¯ä»¥å¤åˆ¶åˆ°å †ä¸Š&lt;/li&gt;
&lt;li&gt;å †å—ï¼Œä¿å­˜åœ¨å †ä¸­&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ MRC çš„ç¯å¢ƒä¸‹è¿è¡Œä¸‹é¢çš„ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (^globalBlock)()  = ^&amp;#123; &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;global block&quot;&lt;/span&gt;); &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, globalBlock);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *str1 = &lt;span class=&quot;string&quot;&gt;@&quot;stack block&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (^stackBlcok)() = ^&amp;#123; &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, str1); &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, stackBlcok);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *str2 = &lt;span class=&quot;string&quot;&gt;@&quot;malloc block&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (^mallockBlock)() = [^&amp;#123; &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, str2); &amp;#125; &lt;span class=&quot;keyword&quot;&gt;copy&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, mallockBlock);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ‰“å°ç»“æœï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-13&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;50.676&lt;/span&gt; BlockExample[&lt;span class=&quot;number&quot;&gt;1760&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;28902&lt;/span&gt;] &amp;lt;__&lt;span class=&quot;built_in&quot;&gt;NSGlobalBlock__&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;0x1000042b0&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-13&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;50.677&lt;/span&gt; BlockExample[&lt;span class=&quot;number&quot;&gt;1760&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;28902&lt;/span&gt;] &amp;lt;__&lt;span class=&quot;built_in&quot;&gt;NSStackBlock__&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;0x7fff5fbff790&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-13&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;50.677&lt;/span&gt; BlockExample[&lt;span class=&quot;number&quot;&gt;1760&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;28902&lt;/span&gt;] &amp;lt;__&lt;span class=&quot;built_in&quot;&gt;NSMallocBlock__&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;0x100303fa0&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç»“æœå’Œæˆ‘ä»¬é¢„æœŸçš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬åœ¨æ¢æˆ ARC çš„ç¯å¢ƒä¸‹è¿è¡Œä¸€æ¬¡ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-13&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;05.767&lt;/span&gt; BlockExample[&lt;span class=&quot;number&quot;&gt;1805&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;29822&lt;/span&gt;] &amp;lt;__&lt;span class=&quot;built_in&quot;&gt;NSGlobalBlock__&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;0x1000052f0&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-13&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;05.768&lt;/span&gt; BlockExample[&lt;span class=&quot;number&quot;&gt;1805&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;29822&lt;/span&gt;] &amp;lt;__&lt;span class=&quot;built_in&quot;&gt;NSMallocBlock__&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;0x100400340&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-13&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;05.769&lt;/span&gt; BlockExample[&lt;span class=&quot;number&quot;&gt;1805&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;29822&lt;/span&gt;] &amp;lt;__&lt;span class=&quot;built_in&quot;&gt;NSMallocBlock__&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;0x1004001b0&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°åŸæ¥çš„æ ˆå—ä¹Ÿå˜æˆäº†å †å—ã€‚è¿™æ˜¯å› ä¸ºåœ¨æŠŠä¸€ä¸ªå¿«èµ‹å€¼ç»™ä¸€ä¸ªstrongå¯¹è±¡æ—¶ ARC ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ‰§è¡Œä¸€æ¬¡copyã€‚å¦‚æœæˆ‘ä»¬ç›´æ¥è¿™æ ·ï¼Œé‚£ä¹ˆè¿˜æ˜¯ä¼šæ‰“å°å‡º __NSStackBlock :&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *str1 = &lt;span class=&quot;string&quot;&gt;@&quot;stack block&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, ^&amp;#123; &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, str1); &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// æ‰“å°ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-13&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;06.180&lt;/span&gt; BlockExample[&lt;span class=&quot;number&quot;&gt;1881&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;32260&lt;/span&gt;] &amp;lt;__&lt;span class=&quot;built_in&quot;&gt;NSStackBlock__&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;0x7fff5fbff798&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrad5.com1.z0.glb.clouddn.com/heading_block.png&quot;&gt;&lt;/div&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å—ï¼ˆBlockï¼‰æ˜¯åœ¨ iOS å¼€å‘ä¸­å¾ˆå¸¸ç”¨çš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒå¯ä»¥ä½¿æˆ‘ä»¬ä»£ç çš„ä¸šåŠ¡é€»è¾‘æ›´åŠ çš„ç´§å‡‘ã€‚æœ¬æ–‡ä¼šåˆ†ä¸¤éƒ¨åˆ†æ¥è®²å—ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯å—çš„åŸºç¡€çŸ¥è¯†ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯å¯¹å—çš„æœ¬è´¨çš„ä¸€äº›ç†è§£ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Objective-C å­¦ä¹ " scheme="http://yoursite.com/categories/Objective-C-%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="Block" scheme="http://yoursite.com/tags/Block/"/>
    
  </entry>
  
  <entry>
    <title>Objective-C runtime çš„ç®€å•ç†è§£ä¸ä½¿ç”¨ï¼ˆäºŒï¼‰</title>
    <link href="http://yoursite.com/2016/03/11/Objective-C-runtime-%E7%9A%84%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3%E4%B8%8E%E4%BD%BF%E7%94%A8%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>http://yoursite.com/2016/03/11/Objective-C-runtime-çš„ç®€å•ç†è§£ä¸ä½¿ç”¨ï¼ˆäºŒï¼‰/</id>
    <published>2016-03-11T12:04:06.000Z</published>
    <updated>2016-03-24T03:30:02.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrad5.com1.z0.glb.clouddn.com/heading_runtime2.png&quot;&gt;&lt;/div&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çŸ¥é“äº† Objective-C ä¸­ç±»çš„æœ¬è´¨ï¼Œä»¥åŠå®ƒçš„æ¶ˆæ¯åˆ†å‘æœºåˆ¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥çœ‹çœ‹é‚£äº›ä¸ runtime ç›¸å…³çš„çš„å‡½æ•°äº†ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬åªä¼šè®²æ¯”è¾ƒå¸¸è§çš„é‚£äº›ã€‚&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;å…³è”å¯¹è±¡ï¼ˆAssociated-Objectï¼‰&quot;&gt;&lt;a href=&quot;#å…³è”å¯¹è±¡ï¼ˆAssociated-Objectï¼‰&quot; class=&quot;headerlink&quot; title=&quot;å…³è”å¯¹è±¡ï¼ˆAssociated Objectï¼‰&quot;&gt;&lt;/a&gt;å…³è”å¯¹è±¡ï¼ˆAssociated Objectï¼‰&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;å…³è”å¯¹è±¡ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ç»™æŸå¯¹è±¡å…³è”è®¸å¤šå…¶ä»–çš„å¯¹è±¡ã€‚è¿™äº›å¯¹è±¡é€šè¿‡ key æ¥åŒºåˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å…³è”å¯¹è±¡ç›¸å…³çš„å‡½æ•°æœ‰ä¸‰ä¸ªï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;objc_setAssociatedObject(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; object, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *key, &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; value, objc_AssociationPolicy policy);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;objc_getAssociatedObject(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; object, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *key);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;objc_removeAssociatedObjects(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; object);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä»å‡½æ•°åæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ä¸‰ä¸ªå‡½æ•°åˆ†åˆ«æ˜¯ç”¨æ¥è®¾ç½®ï¼Œè·å–å’Œç§»é™¤å…³è”å¯¹è±¡çš„ã€‚è¿™é‡Œè¦è§£é‡Šä¸€ä¸‹çš„æ˜¯ä»–ä»¬çš„å‚æ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ä¸ªå‚æ•° id object æ˜¾ç„¶å°±æ˜¯ä½ è¦è®¾ç½®å…³è”å¯¹è±¡çš„é‚£ä¸ªå¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒä¸ªå‚æ•° const void *key å°±æ˜¯ç”¨æ¥åŒºåˆ†ä¸åŒçš„å…³è”å¯¹è±¡çš„ keyï¼Œå› ä¸ºæƒ³è®©ä¸¤ä¸ª key åŒ¹é…åˆ°åŒä¸€ä¸ªå…³è”å¯¹è±¡å°±å¿…é¡»æ˜¯å®Œå…¨ç›¸ç­‰çš„æŒ‡é’ˆï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ç”¨é™æ€å…¨å±€å˜é‡æ¥ä½œä¸º keyã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *AssociatedKey = &lt;span class=&quot;string&quot;&gt;&quot;AssociatedKey&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸‰ä¸ªå‚æ•° id value å°±æ˜¯è¦å…³è”çš„å¯¹è±¡äº†ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬å››ä¸ªå‚æ•° objc_AssociationPolicy policy æŒ‡çš„æ˜¯å…³è”å¯¹è±¡çš„å­˜å‚¨ç­–ç•¥ï¼Œå®ƒæ˜¯ä¸€ä¸ªæšä¸¾ï¼Œå¯ä»¥ä¸ property çš„ attribute ç›¸å¯¹åº”ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; OBJC_ENUM(uintptr_t, objc_AssociationPolicy) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	OBJC_ASSO&lt;span class=&quot;built_in&quot;&gt;CIATION_ASSIGN&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,						 &lt;span class=&quot;comment&quot;&gt;// assign&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	OBJC_ASSO&lt;span class=&quot;built_in&quot;&gt;CIATION_RETAIN_NONATOMIC&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,			   &lt;span class=&quot;comment&quot;&gt;// nonatomic, retain&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	OBJC_ASSO&lt;span class=&quot;built_in&quot;&gt;CIATION_COPY_NONATOMIC&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,				 &lt;span class=&quot;comment&quot;&gt;// nonatomic, copy&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	OBJC_ASSO&lt;span class=&quot;built_in&quot;&gt;CIATION_RETAIN&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;01401&lt;/span&gt;,					 &lt;span class=&quot;comment&quot;&gt;// retain&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	OBJC_ASSO&lt;span class=&quot;built_in&quot;&gt;CIATION_COPY&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;01403&lt;/span&gt;						&lt;span class=&quot;comment&quot;&gt;// copy&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¤§å®¶çŸ¥é“ï¼Œåœ¨ category ä¸­ï¼Œæˆ‘ä»¬æ— æ³•æ·»åŠ  propertyï¼Œå› ä¸ºæ— æ³•æ·»åŠ å®ä¾‹å˜é‡ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ç°åœ¨å°±å¯ä»¥é€šè¿‡å…³è”å¯¹è±¡æ¥å®ç°åœ¨ category ä¸­æ·»åŠ å±æ€§çš„åŠŸèƒ½äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç°åœ¨ CYClass ç±»çš„æ‹“å±•ä¸­å£°æ˜äº†ä¸€ä¸ªå±æ€§&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CYClass&lt;/span&gt; (&lt;span class=&quot;title&quot;&gt;Property&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;copy&lt;/span&gt;)&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *aString;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¦‚æœè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ç›´æ¥åœ¨å¤–éƒ¨è®¿é—®è¿™ä¸ªå±æ€§ï¼Œ é‚£ä¸ªç¨‹åºæ˜¯ä¼š crash çš„ï¼Œä¸ä¿¡ä½ å¯ä»¥è¯•è¯•ğŸ˜…ï¼Œç¼–è¯‘å™¨ä¼šè¯´ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&#39;-[CYClass setAString:]: unrecognized selector sent to instance 0x1001060a0&#39;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬ç»™å®ƒåŠ ä¸Š setter å’Œ getter æ–¹æ³•ï¼Œ å¹¶ä¸”åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­ç»™å®ƒè®¾ç½®å…³è”å¯¹è±¡ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *aStringKey = &lt;span class=&quot;string&quot;&gt;&quot;aStringKey&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CYClass&lt;/span&gt; (&lt;span class=&quot;title&quot;&gt;Property&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)setAString:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)newString&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	objc_setAssociatedObject(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, aStringKey, newString, OBJC_ASSO&lt;span class=&quot;built_in&quot;&gt;CIATION_COPY_NONATOMIC&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)aString&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; objc_getAssociatedObject(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, aStringKey);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬å†è¿›è¡Œè¯»å†™æ“ä½œï¼Œç¨‹åºå°±ä¸ä¼š crash äº†ã€‚å½“ç„¶ï¼Œæ²¡æœ‰å¿…è¦çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯ä¸è¦æ»¥ç”¨å…³è”å¯¹è±¡ï¼Œ å¦åˆ™æœ‰å¯èƒ½ä¼šå‡ºç°ä¸€äº›éš¾ä»¥å‘ç°çš„bugã€‚&lt;br&gt;&lt;!-- more --&gt;&lt;/p&gt;
&lt;h2 id=&quot;æ–¹æ³•è°ƒé…ï¼ˆMethod-Swizzlingï¼‰&quot;&gt;&lt;a href=&quot;#æ–¹æ³•è°ƒé…ï¼ˆMethod-Swizzlingï¼‰&quot; class=&quot;headerlink&quot; title=&quot;æ–¹æ³•è°ƒé…ï¼ˆMethod Swizzlingï¼‰&quot;&gt;&lt;/a&gt;æ–¹æ³•è°ƒé…ï¼ˆMethod Swizzlingï¼‰&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;åœ¨å‰ä¸€ç¯‡åšå®¢ä¸­æˆ‘ä»¬çŸ¥é“äº†æ¯ä¸ªç±»ä¸­çš„æ–¹æ³•æ˜¯ä»¥ objc_method ç»“æ„ä½“çš„å½¢å¼æ”¾åœ¨ methodLists ä¸­çš„ã€‚æ¯ä¸€ä¸ª selector å¯¹åº”äº†ä¸€ä¸ªå®ç°çš„å‡½æ•°çš„æŒ‡é’ˆ IMPã€‚è€Œ method swizzling æŠ€æœ¯å°±æ˜¯é€šè¿‡äº¤æ¢è¿™ä¸ªå‡½æ•°æŒ‡é’ˆæ¥å®ç°çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æœ€å¥½åœ¨ +load æ–¹æ³•ä¸­ä½¿ç”¨ method swizzlingï¼Œå› ä¸º +load æ–¹æ³•å¯¹äºåŠ å…¥è¿è¡ŒæœŸä¸­çš„æ¯ä¸ªç±»åŠåˆ†ç±»éƒ½ä¼šè°ƒç”¨ä¸”åªè°ƒç”¨ä¸€æ¬¡ã€‚æ‰€ä»¥åœ¨è¿™é‡Œäº¤æ¢æ–¹æ³•æ˜¯æœ€å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è‹¹æœä¸ºæˆ‘ä»¬æä¾›äº†å“ªäº›APIæ¥å®ç° method swizzlingï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;IMP class_replaceMethod(Class cls, SEL name, IMP imp, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *types);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯ä»¥ç›´æ¥æ›¿æ¢æ–¹æ³•ï¼Œå½“éœ€è¦çš„æ–¹æ³•ä¸å­˜åœ¨æ—¶ï¼Œä¼šå…ˆè°ƒç”¨ class_addMethod æ¥æ·»åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•ã€‚ä¼šè¿”å›æ›¿æ¢å‰çš„å®ç°å‡½æ•°æŒ‡é’ˆ ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Method class_getInstanceMethod(Class cls, SEL name);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ ¹æ®ç±»å’Œ selector å¾—åˆ° methodï¼Œç”¨æ¥ä½œä¸ºä¸‹é¢ä¸¤ä¸ªæ–¹æ³•çš„å‚æ•°ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;IMP method_setImplementation(Method m, IMP imp);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç›´æ¥ä¸ºä¸€ä¸ªæ–¹æ³•è®¾ç½®å®ƒçš„å®ç°ï¼Œè¿”å›ä¹‹å‰çš„å®ç°å‡½æ•°æŒ‡é’ˆ&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; method_exchangeImplementations(Method m1, Method m2)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°ï¼Œå®é™…ä¸Šå°±æ˜¯è°ƒç”¨äº†ä¸¤æ¬¡ method_setImplementationï¼Œå¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç”¨ method_exchangeImplementations æ¥ç®€å•çš„å°è¯•ä¸€ä¸‹ method swizzlingï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ª NSString çš„åˆ†ç±»ï¼Œç”¨æˆ‘è‡ªå·±çš„æ–¹æ³•äº¤æ¢äº†ç³»ç»Ÿçš„ lowercaseString æ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;NSString&lt;/span&gt; (&lt;span class=&quot;title&quot;&gt;Swizzling&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)load &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Method originalMethod = class_getInstanceMethod([&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; class], &lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(lowercaseString));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Method swappedMthod = class_getInstanceMethod([&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; class], &lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(swizzle_lowercaseString));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    method_exchangeImplementations(originalMethod, swappedMthod);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)swizzle_lowercaseString &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *lowercase = [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; swizzle_lowercaseString];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;FROM: %@  TO:  %@&quot;&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, lowercase);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; lowercase;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯èƒ½æœ‰äººä¼šè§‰å¾—åœ¨è‡ªå·±æ–°å†™çš„ swizzle_lowercaseString æ–¹æ³•ä¸­åˆè°ƒç”¨ [self swizzle_lowercaseString] ä¼šå¯¼è‡´æ­»å¾ªç¯ï¼Œå…¶å®åœ¨äº¤æ¢äº†æ–¹æ³•ä»¥åæˆ‘ä»¬è°ƒç”¨åŸæ¥çš„ lowercaseString æ–¹æ³•å°±ä¼šè¿›å…¥è¿™ä¸ªæ–¹æ³•çš„å®ç°ï¼Œè€Œè¿™æ—¶å€™è°ƒç”¨ swizzle_lowercaseString å…¶å®è°ƒç”¨çš„æ˜¯ç³»ç»ŸåŸæ¥çš„æ–¹æ³•ï¼Œæ‰€ä»¥æ˜¯ä¸ä¼šäº§ç”Ÿæ­»å¾ªç¯çš„ã€‚è¿™é‡Œç†è§£èµ·æ¥å¯èƒ½æœ‰ç‚¹å¥‡æ€ªã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨çœ‹ä¸€ä¸‹è°ƒç”¨çš„ç»“æœ&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-11&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;01&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;05.645&lt;/span&gt; Example[&lt;span class=&quot;number&quot;&gt;4129&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;101067&lt;/span&gt;] FROM: Hello World  TO:  hello world&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å½“ç„¶ method swizzling æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è¿›è¡Œé»‘ç›’æµ‹è¯•ï¼Œåœ¨çœŸæ­£çš„é¡¹ç›®ä¸­å¦‚æœç”¨ method swizzling ä¸€å®šè¦æ ¼å¤–å°å¿ƒã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼ˆMessage-Forwardingï¼‰&quot;&gt;&lt;a href=&quot;#æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼ˆMessage-Forwardingï¼‰&quot; class=&quot;headerlink&quot; title=&quot;æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼ˆMessage Forwardingï¼‰&quot;&gt;&lt;/a&gt;æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼ˆMessage Forwardingï¼‰&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;å½“æˆ‘ä»¬çš„å¯¹è±¡æ¥æ”¶åˆ°ä¸€ä¸ªæ— æ³•è§£è¯»çš„æ¶ˆæ¯æ—¶ï¼Œå°±ä¼šè¿›å…¥æ¶ˆæ¯è½¬å‘ã€‚æ¶ˆæ¯è½¬å‘åˆ†ä¸ºä¸¤å¤§é˜¶æ®µï¼Œç¬¬ä¸€é˜¶æ®µæ˜¯åŠ¨æ€æ–¹æ³•è§£æï¼Œç¬¬äºŒé˜¶æ®µæ˜¯å®Œæ•´çš„æ¶ˆæ¯è½¬å‘ã€‚&lt;/p&gt;
&lt;h3 id=&quot;åŠ¨æ€æ–¹æ³•è§£æï¼ˆdynamic-method-resolutionï¼‰&quot;&gt;&lt;a href=&quot;#åŠ¨æ€æ–¹æ³•è§£æï¼ˆdynamic-method-resolutionï¼‰&quot; class=&quot;headerlink&quot; title=&quot;åŠ¨æ€æ–¹æ³•è§£æï¼ˆdynamic method resolutionï¼‰&quot;&gt;&lt;/a&gt;åŠ¨æ€æ–¹æ³•è§£æï¼ˆdynamic method resolutionï¼‰&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;è¦å®ç°åŠ¨æ€æ–¹æ³•è§£æåªè¦é‡å†™ä¸¤ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt;)resolveInstanceMethod:(SEL)sel; &lt;span class=&quot;comment&quot;&gt;// å¤„ç†æ— æ³•è¯†åˆ«çš„å®ä¾‹æ–¹æ³•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt;)resolveClassMethod:(SEL)sel;    &lt;span class=&quot;comment&quot;&gt;// å¤„ç†æ— æ³•è¯†åˆ«çš„ç±»æ–¹æ³•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªæ–¹æ³•ä¼ è¿›æ¥çš„å‚æ•° selector å°±æ˜¯é‚£ä¸ªæ— æ³•è§£æçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ª selector æ¥åŠ¨æ€çš„ä¸ºè¿™ä¸ªç±»æ·»åŠ æ–¹æ³•ã€‚æ¯”å¦‚åƒä¸‹é¢è¿™æ ·ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; dynamicMethod(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, SEL _cmd) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// do something here&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CYClass&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt;)resolveInstanceMethod:(SEL)sel &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (sel == &lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(someSelector)) &amp;#123;       &lt;span class=&quot;comment&quot;&gt;// å¯¹selectoråšä¸€äº›é€»è¾‘åˆ¤æ–­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        class_addMethod([&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; class], sel, (IMP)dynamicMethod, &lt;span class=&quot;string&quot;&gt;&quot;v@:&quot;&lt;/span&gt;);	&lt;span class=&quot;comment&quot;&gt;// ä¸ºç±»æ·»åŠ æ–¹æ³•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NO&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿˜è¦æä¸€ä¸‹ class_addMethod å‡½æ•°ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;class_addMethod(__unsafe_unretained Class cls, SEL name, IMP imp, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *types);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å®ƒçš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æè¿°è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼å’Œå‚æ•°ç±»å‹çš„ï¼Œç§°ä¹‹ä¸º ç±»å‹ç¼–ç ï¼ˆType Encodingï¼‰ã€‚åœ¨å‰é¢é‚£ä¸ªä¾‹å­é‡Œçš„ â€œv@:â€ ä¸­ï¼Œ v è¡¨ç¤ºè¿”å›å€¼ä¸º voidï¼Œ @ è¡¨ç¤ºç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ idï¼Œ ï¼š è¡¨ç¤ºç¬¬äºŒä¸ªå‚æ•°ç±»å‹æ˜¯ SEL ã€‚&lt;a href=&quot;https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtTypeEncodings.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;æ›´å¤šçš„ç±»å‹ç¼–ç å¯ä»¥çœ‹è¿™é‡Œ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å½“ resolveInstanceMethod: è¿”å› NO æ—¶ï¼Œå°±ä¼šè¿›å…¥æ¶ˆæ¯è½¬å‘çš„ç¬¬äºŒé˜¶æ®µ å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h3 id=&quot;å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶&quot;&gt;&lt;a href=&quot;#å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶&quot; class=&quot;headerlink&quot; title=&quot;å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶&quot;&gt;&lt;/a&gt;å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;å®Œæ•´çš„æ¶ˆæ¯è½¬å‘ä¸»è¦æ¶‰åŠä¸¤ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)forwardingTargetForSelector:(SEL)aSelector;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)forwardInvocation:(&lt;span class=&quot;built_in&quot;&gt;NSInvocation&lt;/span&gt; *)anInvocation;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¦‚æœåœ¨ + resolveInstanceMethod: æ–¹æ³•ä¸­è¿”å›äº† NO é‚£ä¹ˆå°±ä¼šæ‰§è¡Œ - forwardingTargetForSelector: æ–¹æ³•ã€‚åœ¨è¿™ä¸ªæ–¹æ³•å†…æˆ‘ä»¬å¯ä»¥ç»™å¯¹è±¡è¿”å›ä¸€ä¸ªå¤‡æ´çš„æ¥å—è€…æ¥å¤„ç†è¿™ä¸ªä½ç½®çš„ä¿¡æ¯ã€‚åœ¨ CYClass çš„å®ç°ä¸­æˆ‘ä»¬è¿™ä¹ˆå†™ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CYClass&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)forwardingTargetForSelector:(SEL)aSelector &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (aSelector == &lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(unrecognizedSel)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [AnotherClass new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; forwardingTargetForSelector:aSelector];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;AnotherClass çš„å®ä¾‹å°±æ˜¯æˆ‘ä»¬ç”¨æ¥ä½œä¸ºå¤‡æ´æ¥å—è€…çš„å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨ AnotherClass ä¸­å®ç°äº† unrecognizedSel æ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AnotherClass&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)unrecognizedSel &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;forwarding target for unrecognized selector in AnotherClass&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å†ç»™ CYClass çš„å®ä¾‹å‘é€ unrecognizedSel çš„æ¶ˆæ¯å°±ä¸ä¼š crash äº†ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CYClass *c = [CYClass new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[c performSelector:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(unrecognizedSel)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// æ‰“å°ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-03&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-12&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;46&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;30.608&lt;/span&gt; example[&lt;span class=&quot;number&quot;&gt;1577&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;19943&lt;/span&gt;] forwarding target &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; unrecognized selector &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; AnotherClass&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¦‚æœè¿™ä¸€æ­¥æˆ‘ä»¬ä¹Ÿæ²¡æœ‰æä¾›ä¸€ä¸ªå¤‡æ´çš„æ¥æ”¶è€…ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥æœ€åä¸€æ­¥ - forwardInvocation: æ–¹æ³•ï¼Œç³»ç»Ÿä¼šæŠŠæ‰€æœ‰ä¸é‚£æ¡æ¶ˆæ¯ç›¸å…³çš„ä¿¡æ¯å…¨éƒ¨å°è£…åœ¨ä¸€ä¸ª NSInvocation å¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›´æ¥æ”¹å˜è°ƒç”¨çš„ç›®æ ‡ï¼Œ ä¹Ÿå¯ä»¥ä¿®æ”¹æ¶ˆæ¯çš„å†…å®¹åå†è¿›è¡Œè½¬å‘ã€‚æˆ‘ä»¬æŠŠå‰ä¸€ä¸ªæ–¹æ³•å»æ‰ï¼Œç„¶åé‡å†™ä¸€ä¸‹ - forwardInvocation: æ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CYClass&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;NSMethodSignature&lt;/span&gt; *)methodSignatureForSelector:(SEL)aSelector &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;built_in&quot;&gt;NSMethodSignature&lt;/span&gt; signatureWithObjCTypes:&lt;span class=&quot;string&quot;&gt;&quot;v@:&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)forwardInvocation:(&lt;span class=&quot;built_in&quot;&gt;NSInvocation&lt;/span&gt; *)anInvocation &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SEL sel = [anInvocation selector];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (sel == &lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(unrecognizedSel)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [anInvocation invokeWithTarget:[AnotherClass new]];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	[&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; forwardInvocation: anInvocation];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬è¿˜è¦é‡å†™- methodSignatureForSelector: æ–¹æ³•ï¼Œå› ä¸ºç”Ÿæˆ NSInvocation å¯¹è±¡ä¼šè°ƒç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å…³äº forwardInvocation äº†è§£çš„è¿˜ä¸æ˜¯å¾ˆå¤šï¼Œæ‰€ä»¥ä¾‹å­æ¯”è¾ƒç®€å•ï¼Œä»¥åæœ‰äº†æ›´æ·±çš„ç†è§£åä¼šå†åŠ ä¸Šã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ¶ˆæ¯è½¬å‘çš„å…¨è¿‡ç¨‹&quot;&gt;&lt;a href=&quot;#æ¶ˆæ¯è½¬å‘çš„å…¨è¿‡ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;æ¶ˆæ¯è½¬å‘çš„å…¨è¿‡ç¨‹&quot;&gt;&lt;/a&gt;æ¶ˆæ¯è½¬å‘çš„å…¨è¿‡ç¨‹&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;æ€»ç»“&quot;&gt;&lt;a href=&quot;#æ€»ç»“&quot; class=&quot;headerlink&quot; title=&quot;æ€»ç»“&quot;&gt;&lt;/a&gt;æ€»ç»“&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;åˆ°è¿™é‡Œå¯¹äº runtime çš„ç®€å•ç†è§£ä¸ä½¿ç”¨å°±åŸºæœ¬ç»“æŸäº†ã€‚æ€»çš„æ¥è¯´ï¼Œç†è§£äº† Objective-C çš„è¿è¡Œæ—¶ä¼šè®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ çµæ´»ï¼Œå½“ç„¶ä¹Ÿä¼šå¢å¤§ç»´æŠ¤çš„éš¾åº¦ã€‚ä¸è¿‡æƒ³è¦å­¦å¥½ Objective-C è¿™é—¨è¯­è¨€ï¼Œruntime æ˜¯å¿…ä¸å¯å°‘çš„ï¼&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrad5.com1.z0.glb.clouddn.com/heading_runtime2.png&quot;&gt;&lt;/div&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çŸ¥é“äº† Objective-C ä¸­ç±»çš„æœ¬è´¨ï¼Œä»¥åŠå®ƒçš„æ¶ˆæ¯åˆ†å‘æœºåˆ¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥çœ‹çœ‹é‚£äº›ä¸ runtime ç›¸å…³çš„çš„å‡½æ•°äº†ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬åªä¼šè®²æ¯”è¾ƒå¸¸è§çš„é‚£äº›ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Objective-C å­¦ä¹ " scheme="http://yoursite.com/categories/Objective-C-%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="runtime" scheme="http://yoursite.com/tags/runtime/"/>
    
  </entry>
  
  <entry>
    <title>Objective-C runtime çš„ç®€å•ç†è§£ä¸ä½¿ç”¨ï¼ˆä¸€ï¼‰</title>
    <link href="http://yoursite.com/2016/03/10/Objective-C-runtime-%E7%9A%84%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3%E4%B8%8E%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>http://yoursite.com/2016/03/10/Objective-C-runtime-çš„ç®€å•ç†è§£ä¸ä½¿ç”¨ï¼ˆä¸€ï¼‰/</id>
    <published>2016-03-10T11:49:34.000Z</published>
    <updated>2016-03-24T03:30:09.000Z</updated>
    
    <content type="html">&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrad5.com1.z0.glb.clouddn.com/heading_runtime1.png&quot;&gt;&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;ä¸€å¼€å§‹æ¥è§¦ iOS çš„æ—¶å€™ï¼Œå­¦çš„æ˜¯ Swiftã€‚è¿˜æœ‰ä¸€ä¸ªå­¦æœŸå°±å¤§å››ï¼Œä¸ºäº†å®ä¹ ï¼Œä¹Ÿä¸ºäº†æ›´å¥½çš„ç†è§£ iOSï¼Œæœ€è¿‘ä¸€ä¸ªå¤šæœˆå¼€å§‹æ­£å¼å­¦ä¹  Objective-Cã€‚è€Œ runtime â€œè¿è¡Œæ—¶â€ åº”è¯¥ç®—æ˜¯ Objective-C çš„æ ¸å¿ƒæ‰€åœ¨ã€‚æˆ‘è§‰å¾—æœ‰å¿…è¦å¥½å¥½æ¥ç†è§£ä¸€ä¸‹ runtimeã€‚å­¦çš„è¿˜ä¸æ˜¯å¾ˆç²¾ï¼Œä¸»è¦æ˜¯é€šè¿‡çœ‹åˆ«äººçš„åšå®¢å’Œã€ŠEffective Objective-C 2.0ã€‹è¿™æœ¬ä¹¦æ¥å­¦ä¹  runtime ï¼Œå®˜æ–¹æ–‡æ¡£è¿˜æ²¡æœ‰çœ‹è¿‡ï¼Œå¸Œæœ›ä»¥åèƒ½å¤Ÿè¡¥ä¸Šã€‚å¦‚æœæœ‰ä»€ä¹ˆç†è§£çš„ä¸å¯¹çš„åœ°æ–¹ï¼Œå¸Œæœ›å¤§å®¶æŒ‡å‡ºã€‚ğŸ˜†&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;                
&lt;h2 id=&quot;Objective-Cä¸­çš„æ¶ˆæ¯åˆ†å‘&quot;&gt;&lt;a href=&quot;#Objective-Cä¸­çš„æ¶ˆæ¯åˆ†å‘&quot; class=&quot;headerlink&quot; title=&quot;Objective-Cä¸­çš„æ¶ˆæ¯åˆ†å‘&quot;&gt;&lt;/a&gt;Objective-Cä¸­çš„æ¶ˆæ¯åˆ†å‘&lt;/h2&gt;&lt;hr&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[someObject doSomething];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿™æ˜¯æˆ‘ä»¬åœ¨ Objective-C ä¸­è°ƒç”¨æ–¹æ³•çš„æ–¹å¼ï¼Œ ä½†å…¶å®è¿™åº”è¯¥ç§°ä½œ&lt;strong&gt;â€œä¼ é€’æ¶ˆæ¯â€ï¼ˆpass a messageï¼‰&lt;/strong&gt;ï¼Œç»™ someObject å¯¹è±¡ä¼ é€’ä¸€ä¸ª doSomethingçš„æ¶ˆæ¯ã€‚å› ä¸ºè¿™è¡Œä»£ç åœ¨ç¼–è¯‘æ—¶ä¼šå˜æˆè¿™æ ·ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;objc_msgSend(someObject, &lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(doSomething))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿™æ˜¯ä¸ª C å‡½æ•°ï¼Œ å£°æ˜åœ¨ objc/message.h å¤´æ–‡ä»¶ä¸­ï¼Œå®ƒæ¥å—ä¸¤ä¸ªåŠä»¥ä¸Šçš„å¯å˜å‚æ•°, ç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨çš„æ˜¯æ¶ˆæ¯çš„æ¥æ”¶è€…ï¼Œç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨é€‰æ‹©å­ï¼ˆ&lt;a href=&quot;#selector&quot;&gt;selectorï¼Œåœ¨åé¢æˆ‘ä»¬ä¼šç»†è¯´&lt;/a&gt;ï¼‰ï¼Œå¦‚æœè¦è°ƒç”¨çš„æ–¹æ³•è¿˜æœ‰åˆ«çš„å‚æ•°ï¼Œå°±ä¼šè·Ÿåœ¨è¿™ä¸¤ä¸ªå‚æ•°åé¢ã€‚è¿˜æœ‰å…¶ä»–å‡ ä¸ªç±»ä¼¼çš„å‡½æ•°ï¼Œæ¥å¤„ç†ä¸åŒçš„æƒ…å†µï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; objc_msgSend(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, SEL op, ...)	&lt;span class=&quot;comment&quot;&gt;// ç›´æ¥å‘é€æ¶ˆæ¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; objc_msgSendSuper(&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; objc_super *&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;, SEL op, ...)	&lt;span class=&quot;comment&quot;&gt;// ç»™çˆ¶ç±»å‘é€æ¶ˆæ¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; objc_msgSend_stret(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, SEL op, ...)	&lt;span class=&quot;comment&quot;&gt;// è¿”å›å€¼æ˜¯ç»“æ„ä½“æ—¶ï¼Œå¯ä»¥äº¤ç»™è¿™ä¸ªå‡½æ•°å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; objc_msgSend_fpret(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, SEL op, ...)	&lt;span class=&quot;comment&quot;&gt;// è¿”å›å€¼æ˜¯æµ®ç‚¹æ•°æ—¶ï¼Œå¯ä»¥äº¤ç»™è¿™ä¸ªå‡½æ•°å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;......&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å½“æˆ‘ä»¬å‘ä¸€ä¸ªå¯¹è±¡å‘é€ä¸€ä¸ªæ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šåœ¨è¿™ä¸ªå¯¹è±¡çš„ç±»ä¸­æ ¹æ® selector æ‰¾åˆ°çœŸæ­£çš„å®ç°å‡½æ•°ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±å†åˆ°å®ƒçš„çˆ¶ç±»ä¸­æ‰¾ï¼Œä¸€å±‚ä¸€å±‚çš„æ‰¾ä¸Šå»ï¼Œæœ€ååˆ° NSObject ç±»ä¸­ï¼Œ å¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆå°±ä¼šå¯ç”¨â€œæ¶ˆæ¯è½¬å‘æœºåˆ¶â€ã€‚è¿™ä¸ªæˆ‘ä»¬ä»¥åå†æã€‚&lt;/p&gt;
&lt;h4 id=&quot;æ¶ˆæ¯åˆ†å‘å›¾ç¤º&quot;&gt;&lt;a href=&quot;#æ¶ˆæ¯åˆ†å‘å›¾ç¤º&quot; class=&quot;headerlink&quot; title=&quot;æ¶ˆæ¯åˆ†å‘å›¾ç¤º&quot;&gt;&lt;/a&gt;æ¶ˆæ¯åˆ†å‘å›¾ç¤º&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/messaging1.gif&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Objective-Cä¸­ç±»çš„æœ¬è´¨&quot;&gt;&lt;a href=&quot;#Objective-Cä¸­ç±»çš„æœ¬è´¨&quot; class=&quot;headerlink&quot; title=&quot;Objective-Cä¸­ç±»çš„æœ¬è´¨&quot;&gt;&lt;/a&gt;Objective-Cä¸­ç±»çš„æœ¬è´¨&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;Objective-C ä¸­çš„ç±»å…¶å®æ˜¯ C ä¸­çš„ç»“æ„ä½“ï¼Œå®ƒçš„åŸºæœ¬å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; objc_class &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Class isa ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Class super_class ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *name ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; version ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; info ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; instance_size ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; objc_ivar_list *ivars ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; objc_method_list **methodLists ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; objc_cache *cache ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; objc_protocol_list *protocols ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/* Use `Class` instead of `struct objc_class *` */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å…¶ä¸­æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªå˜é‡&lt;/p&gt;
&lt;h3 id=&quot;Class-isa&quot;&gt;&lt;a href=&quot;#Class-isa&quot; class=&quot;headerlink&quot; title=&quot;Class isa&quot;&gt;&lt;/a&gt;Class isa&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;isa æŒ‡é’ˆï¼Œè¡¨ç¤ºè¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªä»€ä¹ˆç±»ã€‚è€Œ &lt;strong&gt;Class&lt;/strong&gt; ç±»å‹ï¼Œ ä¹Ÿå°±æ˜¯ &lt;strong&gt;struct objc_class *&lt;/strong&gt; ï¼Œè¿™æ˜¯è‹¹æœåœ¨ä¸‹é¢çš„æ³¨é‡Šä¸­å†™åˆ°çš„ã€‚è¿™è¯´æ˜ç±»æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚åœ¨ç±»å¯¹è±¡ä¸­çš„ isa æŒ‡å‘çš„ç±»å«åš&lt;strong&gt;â€œå…ƒç±»â€&lt;/strong&gt;ï¼Œç±»æ–¹æ³•å°±å®šä¹‰åœ¨å…ƒç±»ä¸­ã€‚&lt;br&gt;æ€»çš„æ¥è¯´å°±æ˜¯ï¼Œä¸€ä¸ªç±»å¯ä»¥æœ‰å¾ˆå¤šçš„å®ä¾‹ï¼Œè¿™äº›å®ä¾‹æœ‰ç€å”¯ä¸€çš„ä¸€ä¸ªç±»å¯¹è±¡ï¼Œè€Œè¿™ä¸ªç±»å¯¹è±¡ä¹Ÿæœ‰ç€å”¯ä¸€çš„ä¸€ä¸ªå…ƒç±»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;å®ä¾‹ï¼Œç±»ï¼Œçˆ¶ç±»ï¼Œå…ƒç±»ä¹‹é—´çš„å…³ç³»&quot;&gt;&lt;a href=&quot;#å®ä¾‹ï¼Œç±»ï¼Œçˆ¶ç±»ï¼Œå…ƒç±»ä¹‹é—´çš„å…³ç³»&quot; class=&quot;headerlink&quot; title=&quot;å®ä¾‹ï¼Œç±»ï¼Œçˆ¶ç±»ï¼Œå…ƒç±»ä¹‹é—´çš„å…³ç³»&quot;&gt;&lt;/a&gt;å®ä¾‹ï¼Œç±»ï¼Œçˆ¶ç±»ï¼Œå…ƒç±»ä¹‹é—´çš„å…³ç³»&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;http://7xrpns.com1.z0.glb.clouddn.com/%E7%B1%BB%E5%92%8C%E5%85%83%E7%B1%BB.png&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Class-super-class&quot;&gt;&lt;a href=&quot;#Class-super-class&quot; class=&quot;headerlink&quot; title=&quot;Class super_class&quot;&gt;&lt;/a&gt;Class super_class&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;super_class æŒ‡å‘çš„å°±æ˜¯å®ƒçš„çˆ¶ç±»ã€‚ &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;struct-objc-ivar-list-ivars&quot;&gt;&lt;a href=&quot;#struct-objc-ivar-list-ivars&quot; class=&quot;headerlink&quot; title=&quot;struct objc_ivar_list *ivars&quot;&gt;&lt;/a&gt;struct objc_ivar_list *ivars&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;ivars æŒ‡å‘çš„æ˜¯æˆå‘˜å˜é‡çš„åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span id=&quot;selector&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;struct-objc-method-list-methodLists&quot;&gt;&lt;a href=&quot;#struct-objc-method-list-methodLists&quot; class=&quot;headerlink&quot; title=&quot;struct objc_method_list **methodLists&quot;&gt;&lt;/a&gt;struct objc_method_list **methodLists&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;methodLists æŒ‡å‘çš„å°±æ˜¯æ–¹æ³•çš„åˆ—è¡¨ã€‚åœ¨ method_list ä¸­å­˜ç€ objc_method ç±»å‹çš„æ•°ç»„ã€‚è€Œ objc_method çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; objc_method &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SEL method_name ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *method_types ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    IMP method_imp ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; (*IMP)(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;, SEL, ...); 	&lt;span class=&quot;comment&quot;&gt;// IMP å°±æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;çœ‹åˆ°è¿™ä¸ªç»“æ„ä½“ï¼Œ æˆ‘ä»¬åº”è¯¥å°±å¾ˆæ˜ç¡® selector çš„æ„ä¹‰äº†ã€‚&lt;strong&gt;selector&lt;/strong&gt; å…¶å®å°±æ˜¯&lt;strong&gt;æ–¹æ³•çš„ä¸€ä¸ªæ ‡ç¤º&lt;/strong&gt;ï¼Œè€Œ &lt;strong&gt;method_imp&lt;/strong&gt; æŒ‡å‘çš„æ‰æ˜¯&lt;strong&gt;çœŸæ­£çš„å‡½æ•°å®ç°&lt;/strong&gt;ã€‚å½“æˆ‘ä»¬å‘å¯¹è±¡å‘é€æ¶ˆæ¯åï¼Œ runtimeæ ¹æ® selector è¿™ä¸ªæ ‡ç¤ºï¼Œåœ¨method_listä¸­æ‰¾åˆ°å¯¹åº”çš„ objc_methodï¼Œå–åˆ°çœŸæ­£çš„å‡½æ•°çš„åœ°å€ï¼Œå†æ‰§è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;struct-objc-cache-cache&quot;&gt;&lt;a href=&quot;#struct-objc-cache-cache&quot; class=&quot;headerlink&quot; title=&quot;struct objc_cache *cache&quot;&gt;&lt;/a&gt;struct objc_cache *cache&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;cache ç”¨æ¥ç¼“å­˜æœ€è¿‘è°ƒç”¨è¿‡çš„çš„æ–¹æ³•ã€‚ å¦‚æœæ¯æ¬¡å‘å¯¹è±¡å‘é€æ¶ˆæ¯éƒ½è¦éå†ä¸€éæ–¹æ³•åˆ—è¡¨é‚£ä¼šå¾ˆæµªè´¹æ—¶é—´ï¼Œ æ‰€ä»¥ä¼šæŠŠæœ€è¿‘è°ƒç”¨è¿‡çš„æ–¹æ³•æ”¾åœ¨ç¼“å­˜ä¸­ã€‚æ¯ä¸€æ¬¡å‘é€æ¶ˆæ¯æ—¶ï¼Œä¼šå…ˆæŸ¥è¯¢ç¼“å­˜ï¼Œç¼“å­˜ä¸­æ‰¾ä¸åˆ°å†å»æ–¹æ³•åˆ—è¡¨ä¸­æ‰¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;struct-objc-protocol-list-protocols&quot;&gt;&lt;a href=&quot;#struct-objc-protocol-list-protocols&quot; class=&quot;headerlink&quot; title=&quot;struct objc_protocol_list *protocols&quot;&gt;&lt;/a&gt;struct objc_protocol_list *protocols&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;protocols æŒ‡å‘åè®®åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Runtimeèƒ½åšä»€ä¹ˆ&quot;&gt;&lt;a href=&quot;#Runtimeèƒ½åšä»€ä¹ˆ&quot; class=&quot;headerlink&quot; title=&quot;Runtimeèƒ½åšä»€ä¹ˆ&quot;&gt;&lt;/a&gt;Runtimeèƒ½åšä»€ä¹ˆ&lt;/h2&gt;&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;åŠ¨æ€çš„æ”¹å˜æˆå‘˜å˜é‡çš„å€¼&lt;/li&gt;
&lt;li&gt;åœ¨è¿è¡Œæ—¶æ·»åŠ æ–¹æ³•&lt;/li&gt;
&lt;li&gt;äº¤æ¢æ–¹æ³•çš„å®ç°&lt;/li&gt;
&lt;li&gt;ç»™ä¸€ä¸ªå¯¹è±¡å…³è”å…¶ä»–å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯è½¬å‘&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç­‰ç­‰ï¼Œè®¸è®¸å¤šå¤šæˆ‘ä»¬æƒ³ä¸åˆ°çš„åŠŸèƒ½&lt;/p&gt;
&lt;p&gt;runtimeçš„ä½¿ç”¨åœ¨ä¸‹ä¸€ç¯‡åšå®¢ä¸­å†è¯¦ç»†è®² ~&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://7xrad5.com1.z0.glb.clouddn.com/heading_runtime1.png&quot;&gt;&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;ä¸€å¼€å§‹æ¥è§¦ iOS çš„æ—¶å€™ï¼Œå­¦çš„æ˜¯ Swiftã€‚è¿˜æœ‰ä¸€ä¸ªå­¦æœŸå°±å¤§å››ï¼Œä¸ºäº†å®ä¹ ï¼Œä¹Ÿä¸ºäº†æ›´å¥½çš„ç†è§£ iOSï¼Œæœ€è¿‘ä¸€ä¸ªå¤šæœˆå¼€å§‹æ­£å¼å­¦ä¹  Objective-Cã€‚è€Œ runtime â€œè¿è¡Œæ—¶â€ åº”è¯¥ç®—æ˜¯ Objective-C çš„æ ¸å¿ƒæ‰€åœ¨ã€‚æˆ‘è§‰å¾—æœ‰å¿…è¦å¥½å¥½æ¥ç†è§£ä¸€ä¸‹ runtimeã€‚å­¦çš„è¿˜ä¸æ˜¯å¾ˆç²¾ï¼Œä¸»è¦æ˜¯é€šè¿‡çœ‹åˆ«äººçš„åšå®¢å’Œã€ŠEffective Objective-C 2.0ã€‹è¿™æœ¬ä¹¦æ¥å­¦ä¹  runtime ï¼Œå®˜æ–¹æ–‡æ¡£è¿˜æ²¡æœ‰çœ‹è¿‡ï¼Œå¸Œæœ›ä»¥åèƒ½å¤Ÿè¡¥ä¸Šã€‚å¦‚æœæœ‰ä»€ä¹ˆç†è§£çš„ä¸å¯¹çš„åœ°æ–¹ï¼Œå¸Œæœ›å¤§å®¶æŒ‡å‡ºã€‚ğŸ˜†&lt;/p&gt;
    
    </summary>
    
      <category term="Objective-C å­¦ä¹ " scheme="http://yoursite.com/categories/Objective-C-%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="runtime" scheme="http://yoursite.com/tags/runtime/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬ä¸€ç¯‡åšå®¢</title>
    <link href="http://yoursite.com/2016/03/10/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
    <id>http://yoursite.com/2016/03/10/ç¬¬ä¸€ç¯‡åšå®¢/</id>
    <published>2016-03-10T03:04:16.000Z</published>
    <updated>2016-03-18T01:47:35.000Z</updated>
    
    <content type="html">&lt;p&gt;èŠ±äº†ä¸€ä¸ªæ™šä¸ŠåŠ ä¸Šä¸€ä¸ªä¸Šåˆçš„æ—¶é—´ï¼Œç»ˆäºæŠŠè‡ªå·±çš„åšå®¢æ­èµ·æ¥äº†ã€‚ä»¥åè¦å¥½å¥½å­¦ä¹ ï¼Œ è®¤çœŸçš„å†™åšå®¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;å—¯ï¼Œ ç¬¬ä¸€ç¯‡åšå®¢å°±æ˜¯è¿™ä¹ˆç®€çŸ­ï¼Œæ‹œæ‹œ~ ğŸ˜†&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;èŠ±äº†ä¸€ä¸ªæ™šä¸ŠåŠ ä¸Šä¸€ä¸ªä¸Šåˆçš„æ—¶é—´ï¼Œç»ˆäºæŠŠè‡ªå·±çš„åšå®¢æ­èµ·æ¥äº†ã€‚ä»¥åè¦å¥½å¥½å­¦ä¹ ï¼Œ è®¤çœŸçš„å†™åšå®¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;å—¯ï¼Œ ç¬¬ä¸€ç¯‡åšå®¢å°±æ˜¯è¿™ä¹ˆç®€çŸ­ï¼Œæ‹œæ‹œ~ ğŸ˜†&lt;/p&gt;

    
    </summary>
    
    
  </entry>
  
</feed>
